import{_ as Ue,B as Ce,m as Re,p as W,r as i,Q as X,T as Te,R as ze,a as n,H as Y,o as c,l as P,d as e,w as t,I as D,f as o,h as Z,j as g,U as ee,J as L,c as v,e as u,x as K,i as h,F as $e,C as Fe,D as Ne,z as qe,A as Pe,n as Le}from"./index.2b31a27b.js";import{l as Be,d as Qe,c as je,g as Ae,a as Ee,b as He}from"./datasetKnowledge.f95e40db.js";const z=U=>(qe("data-v-3ca59760"),U=U(),Pe(),U),Me={style:{"padding-bottom":"30px"}},Je={style:{"white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}},Oe=z(()=>u("i",{class:"fa-solid fa-file-pdf",style:{"font-size":"20px"}},null,-1)),Ge={key:0},We={style:{display:"flex","flex-direction":"column"}},Xe={class:"dialog-footer"},Ye={style:{"margin-bottom":"20px"}},Ze={style:{display:"flex","align-items":"center",gap:"3px"}},et=z(()=>u("div",{class:"el-upload__text"},[g("\u5C06\u6587\u4EF6\u62D6\u5230\u6B64\u5904\uFF0C\u6216"),u("em",null,"\u70B9\u51FB\u4E0A\u4F20")],-1)),tt={class:"el-upload__tip text-center"},lt={class:"el-upload__tip"},at=z(()=>u("span",null," \u662F\u5426\u66F4\u65B0\u5DF2\u7ECF\u5B58\u5728\u7684\u5E94\u7528\u6570\u636E ",-1)),ot=z(()=>u("span",null,"\u652F\u6301 .txt, .doc, .docx, .pdf, .md \u6587\u4EF6\u3002",-1)),nt={class:"dialog-footer"},dt=Ce({name:"DatasetKnowledge"}),st=Object.assign(dt,{setup(U){Re();const{proxy:m}=Le(),C=W("datasetId"),B=i([]),V=i(!1),$=i(!0),R=i(!0),F=i([]),te=i(!0),le=i(!0),N=i(0),Q=i(""),j=i([]),q=i(null);i(""),i(void 0),i(void 0),i([]),i([]);const ae=i([{code:"direct_segmentation",name:"\u76F4\u63A5\u5206\u6BB5"},{code:"enhanced_processing",name:"\u589E\u5F3A\u5904\u7406"},{code:"qa_split",name:"\u95EE\u7B54\u62C6\u5206"}]),f=X({open:!1,title:"",isUploading:!1,updateSupport:0,headers:{Authorization:"Bearer "+Te()},url:"/prod-api/api/infra/base/search/datasetKnowledge/importData"}),k=i([{key:0,label:"\u56FE\u6807",visible:!0},{key:1,label:"\u6570\u636E\u96C6\u540D\u79F0",visible:!0},{key:2,label:"\u6240\u6709\u8005",visible:!0},{key:3,label:"\u63CF\u8FF0\u4FE1\u606F",visible:!0},{key:4,label:"\u72B6\u6001",visible:!0},{key:5,label:"\u8BBF\u95EE\u6743\u9650",visible:!0},{key:6,label:"\u6570\u636E\u603B\u91CF",visible:!0},{key:7,label:"\u521B\u5EFA\u65F6\u95F4",visible:!0},{key:8,label:"\u7F16\u8F91",visible:!0}]),oe=X({form:{},queryParams:{pageNum:1,pageSize:10,datasetId:W("datasetId"),DatasetKnowledgeName:void 0,name:void 0,ownerId:void 0,status:void 0,deptId:void 0},rules:{datasetKnowledgeId:[{required:!0,message:"\u5E94\u7528\u7F16\u53F7\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],name:[{required:!0,message:"\u5E94\u7528\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},{min:2,max:20,message:"\u5E94\u7528\u540D\u79F0\u957F\u5EA6\u5FC5\u987B\u4ECB\u4E8E 2 \u548C 20 \u4E4B\u95F4",trigger:"blur"}],ownerId:[{required:!0,message:"\u663E\u793A\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],description:[{required:!0,message:"\u63CF\u8FF0\u4FE1\u606F\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],datasetStatus:[{required:!0,message:"\u57DF\u540D\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],accessPermission:[{required:!0,message:"\u5B89\u5168\u5B58\u50A8\u8DEF\u5F84\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],datasetSize:[{required:!0,message:"\u5E94\u7528\u76EE\u6807\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}}),{queryParams:r,form:s,rules:ne}=ze(oe);function b(){console.log("currentDatasetId = "+C),$.value=!0,Be(m.addDateRange(r.value,j.value)).then(d=>{$.value=!1,B.value=d.rows,N.value=d.total})}function T(){console.log(r),r.value.pageNum=1,b()}function de(){j.value=[],m.resetForm("queryRef"),r.value.name=void 0,r.value.ownerId=void 0,m.$refs.deptTreeRef.setCurrentKey(null),T()}function se(d){const a=d.id||F.value;m.$modal.confirm('\u662F\u5426\u786E\u8BA4\u5220\u9664\u5E94\u7528\u7F16\u53F7\u4E3A"'+a+'"\u7684\u6570\u636E\u9879\uFF1F').then(function(){return Qe(a)}).then(()=>{b(),m.$modal.msgSuccess("\u5220\u9664\u6210\u529F")}).catch(()=>{})}function ie(d){F.value=d.map(a=>a.id),te.value=d.length!=1,le.value=!d.length}function A(){s.value={datasetKnowledgeId:void 0,name:void 0,ownerId:void 0,description:void 0,datasetStatus:void 0,accessPermission:void 0,datasetSize:void 0},m.resetForm("DatasetKnowledgeRef")}function ue(){V.value=!1,A()}const re=async(d,a,p)=>{const _=await je({field:d,value:a?1:0,id:p}).catch(()=>{});_&&_.code==200&&b()};function pe(d){A();const a=d.id||F.value;Ae(a).then(p=>{s.value=p.data,s.value.datasetKnowledgeId=a,V.value=!0,Q.value="\u4FEE\u6539\u5E94\u7528"})}function ce(){m.download("system/user/importTemplate",{},`user_template_${new Date().getTime()}.xlsx`)}const me=(d,a,p)=>{f.isUploading=!0},fe=(d,a,p)=>{f.open=!1,f.isUploading=!1,m.$refs.uploadRef.handleRemove(a),m.$alert("<div style='overflow: auto;overflow-x: hidden;max-height: 70vh;padding: 10px 20px 0;'>"+d.msg+"</div>","\u5BFC\u5165\u7ED3\u679C",{dangerouslyUseHTMLString:!0}),b()};function _e(){m.$refs.uploadRef.submit()}function ge(){m.$refs.DatasetKnowledgeRef.validate(d=>{d&&(s.value.datasetKnowledgeId!=null?Ee(s.value).then(a=>{m.$modal.msgSuccess("\u4FEE\u6539\u6210\u529F"),V.value=!1,b()}):He(s.value).then(a=>{m.$modal.msgSuccess("\u65B0\u589E\u6210\u529F"),V.value=!1,b()}))})}return b(),(d,a)=>{const p=n("el-input"),_=n("el-form-item"),w=n("el-button"),E=n("el-form"),H=n("router-link"),y=n("el-col"),ve=n("right-toolbar"),x=n("el-row"),S=n("el-table-column"),we=n("el-switch"),M=n("el-tooltip"),he=n("el-table"),be=n("pagination"),J=n("el-dialog"),ye=n("QuestionFilled"),O=n("el-icon"),xe=n("el-radio"),ke=n("el-radio-group"),Se=n("upload-filled"),Ve=n("el-checkbox"),Ie=n("el-link"),De=n("el-upload"),G=Y("hasPermi"),Ke=Y("loading");return c(),P("div",Me,[e(x,{gutter:20},{default:t(()=>[e(y,{span:24,xs:24},{default:t(()=>[D(e(E,{model:o(r),ref:"queryRef",inline:!0,"label-width":"100px"},{default:t(()=>[e(_,{label:"\u6570\u636E\u96C6\u540D\u79F0",prop:"name"},{default:t(()=>[e(p,{modelValue:o(r)["condition[name|like]"],"onUpdate:modelValue":a[0]||(a[0]=l=>o(r)["condition[name|like]"]=l),placeholder:"\u8BF7\u8F93\u5165\u5E94\u7528\u540D\u79F0",clearable:"",style:{width:"240px"},onKeyup:Z(T,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),e(_,{label:"\u6240\u6709\u8005",prop:"ownerId","label-width":"100px"},{default:t(()=>[e(p,{modelValue:o(r)["condition[ownerId|like]"],"onUpdate:modelValue":a[1]||(a[1]=l=>o(r)["condition[ownerId|like]"]=l),placeholder:"\u8BF7\u8F93\u5165\u663E\u793A\u540D\u79F0",clearable:"",style:{width:"240px"},onKeyup:Z(T,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),e(_,null,{default:t(()=>[e(w,{type:"primary",icon:"Search",onClick:T},{default:t(()=>[g("\u641C\u7D22")]),_:1}),e(w,{icon:"Refresh",onClick:de},{default:t(()=>[g("\u91CD\u7F6E")]),_:1})]),_:1})]),_:1},8,["model"]),[[ee,o(R)]]),e(x,{gutter:10,class:"mb8"},{default:t(()=>[e(y,{span:1.5},{default:t(()=>[e(H,{to:"/base/search/vectorData/dataUpload?datasetId="+o(C)},{default:t(()=>[e(w,{type:"primary",plain:"",icon:"Upload"},{default:t(()=>[g("\u6570\u636E\u96C6\u4E0A\u4F20")]),_:1})]),_:1},8,["to"])]),_:1},8,["span"]),e(ve,{showSearch:o(R),"onUpdate:showSearch":a[2]||(a[2]=l=>L(R)?R.value=l:null),onQueryTable:b,columns:o(k)},null,8,["showSearch","columns"])]),_:1}),D((c(),v(he,{data:o(B),onSelectionChange:ie},{default:t(()=>[e(S,{type:"selection",width:"50",align:"center"}),o(k)[1].visible?(c(),v(S,{label:"\u6587\u6863\u540D\u79F0",align:"left",key:"name",prop:"name","show-overflow-tooltip":!0},{default:t(l=>[u("div",Je,[Oe,e(H,{to:"/base/search/vectorData/knowledgeDetail?id="+l.row.id+"&datasetId="+o(C)},{default:t(()=>[g(K(l.row.documentName),1)]),_:2},1032,["to"])])]),_:1})):h("",!0),o(k)[3].visible?(c(),v(S,{label:"\u5206\u5272\u6A21\u5F0F",align:"center",key:"description",prop:"description","show-overflow-tooltip":!0},{default:t(l=>[l.row.processingMethod=="direct_segmentation"?(c(),P("div",Ge," \u76F4\u63A5\u5206\u6BB5 ")):h("",!0)]),_:1})):h("",!0),o(k)[2].visible?(c(),v(S,{label:"\u6570\u636E\u6570\u91CF",align:"center",width:"130",key:"documentCount",prop:"documentCount","show-overflow-tooltip":!0})):h("",!0),o(k)[7].visible?(c(),v(S,{key:3,label:"\u521B\u5EFA/\u66F4\u65B0\u65F6\u95F4",align:"center",prop:"addTime",width:"200"},{default:t(l=>[u("div",We,[u("span",null,K(d.parseTime(l.row.addTime)),1),u("span",null,K(d.parseTime(l.row.updateTime)),1)])]),_:1})):h("",!0),o(k)[4].visible?(c(),v(S,{label:"\u72B6\u6001",align:"center",width:"300",key:"datasetStatus",prop:"datasetStatus","show-overflow-tooltip":!0},{default:t(l=>[e(w,{type:"primary",text:"",bg:"",icon:"Link"},{default:t(()=>[g(K(l.row.status),1)]),_:2},1024)]),_:1})):h("",!0),o(k)[1].visible?(c(),v(S,{label:"\u5F00\u542F",align:"center",width:"100",key:"hasStatus",prop:"hasStatus","show-overflow-tooltip":!0},{default:t(l=>[e(we,{modelValue:l.row.hasStatus,"onUpdate:modelValue":I=>l.row.hasStatus=I,"active-value":0,"inactive-value":1,onChange:I=>re("hasStatus",l.row.hasStatus,l.row.id)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1})):h("",!0),o(k)[8].visible?(c(),v(S,{key:6,label:"\u64CD\u4F5C",align:"center",width:"150","class-name":"small-padding fixed-width"},{default:t(l=>[l.row.datasetKnowledgeId!==1?(c(),v(M,{key:0,content:"\u4FEE\u6539",placement:"top"},{default:t(()=>[D(e(w,{link:"",type:"primary",icon:"Edit",onClick:I=>pe(l.row)},null,8,["onClick"]),[[G,["system:DatasetKnowledge:edit"]]])]),_:2},1024)):h("",!0),l.row.datasetKnowledgeId!==1?(c(),v(M,{key:1,content:"\u5220\u9664",placement:"top"},{default:t(()=>[D(e(w,{link:"",type:"primary",icon:"Delete",onClick:I=>se(l.row)},null,8,["onClick"]),[[G,["system:DatasetKnowledge:remove"]]])]),_:2},1024)):h("",!0)]),_:1})):h("",!0)]),_:1},8,["data"])),[[Ke,o($)]]),D(e(be,{total:o(N),page:o(r).pageNum,"onUpdate:page":a[3]||(a[3]=l=>o(r).pageNum=l),limit:o(r).pageSize,"onUpdate:limit":a[4]||(a[4]=l=>o(r).pageSize=l),onPagination:b},null,8,["total","page","limit"]),[[ee,o(N)>0]])]),_:1})]),_:1}),e(J,{title:o(Q),modelValue:o(V),"onUpdate:modelValue":a[11]||(a[11]=l=>L(V)?V.value=l:null),width:"900px","append-to-body":""},{footer:t(()=>[u("div",Xe,[e(w,{type:"primary",onClick:ge},{default:t(()=>[g("\u786E \u5B9A")]),_:1}),e(w,{onClick:ue},{default:t(()=>[g("\u53D6 \u6D88")]),_:1})])]),default:t(()=>[e(E,{model:o(s),rules:o(ne),ref:"DatasetKnowledgeRef","label-width":"100px"},{default:t(()=>[e(x,null,{default:t(()=>[e(y,{span:24},{default:t(()=>[e(_,{label:"\u6587\u6863\u540D\u79F0",prop:"documentName"},{default:t(()=>[e(p,{modelValue:o(s).documentName,"onUpdate:modelValue":a[5]||(a[5]=l=>o(s).documentName=l),placeholder:"\u8BF7\u8F93\u5165\u6587\u6863\u540D\u79F0",maxlength:"50"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(x,null,{default:t(()=>[e(y,{span:24},{default:t(()=>[e(_,{label:"\u6570\u636E\u96C6\u6570\u91CF",prop:"ownerId"},{default:t(()=>[e(p,{modelValue:o(s).ownerId,"onUpdate:modelValue":a[6]||(a[6]=l=>o(s).ownerId=l),placeholder:"\u8BF7\u8F93\u5165\u6570\u636E\u96C6\u6570\u636E",maxlength:"50"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(x,null,{default:t(()=>[e(y,{span:24},{default:t(()=>[e(_,{label:"\u72B6\u6001",prop:"datasetStatus"},{default:t(()=>[e(p,{modelValue:o(s).datasetStatus,"onUpdate:modelValue":a[7]||(a[7]=l=>o(s).datasetStatus=l),placeholder:"\u8BF7\u8F93\u5165\u57DF\u540D",maxlength:"100"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(x,null,{default:t(()=>[e(y,{span:24},{default:t(()=>[e(_,{label:"\u63CF\u8FF0\u4FE1\u606F",prop:"description"},{default:t(()=>[e(p,{modelValue:o(s).description,"onUpdate:modelValue":a[8]||(a[8]=l=>o(s).description=l),placeholder:"\u8BF7\u8F93\u5165\u63CF\u8FF0\u4FE1\u606F",maxlength:"100"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(x,null,{default:t(()=>[e(y,{span:24},{default:t(()=>[e(_,{label:"\u8BBF\u95EE\u6743\u9650",prop:"accessPermission"},{default:t(()=>[e(p,{modelValue:o(s).accessPermission,"onUpdate:modelValue":a[9]||(a[9]=l=>o(s).accessPermission=l),placeholder:"\u8BF7\u8F93\u5165\u5B89\u5168\u5B58\u50A8\u8DEF\u5F84",maxlength:"200"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(x,null,{default:t(()=>[e(y,{span:24},{default:t(()=>[e(_,{label:"\u6570\u636E\u603B\u91CF",prop:"datasetSize"},{default:t(()=>[e(p,{modelValue:o(s).datasetSize,"onUpdate:modelValue":a[10]||(a[10]=l=>o(s).datasetSize=l),placeholder:"\u8BF7\u8F93\u5165\u5E94\u7528\u76EE\u6807",maxlength:"20"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"]),e(J,{title:f.title,modelValue:f.open,"onUpdate:modelValue":a[15]||(a[15]=l=>f.open=l),width:"800px","append-to-body":""},{footer:t(()=>[u("div",nt,[e(w,{type:"primary",onClick:_e},{default:t(()=>[g("\u786E \u5B9A")]),_:1}),e(w,{onClick:a[14]||(a[14]=l=>f.open=!1)},{default:t(()=>[g("\u53D6 \u6D88")]),_:1})])]),default:t(()=>[e(x,null,{default:t(()=>[e(y,{span:24},{default:t(()=>[u("div",Ye,[e(ke,{modelValue:o(q),"onUpdate:modelValue":a[12]||(a[12]=l=>L(q)?q.value=l:null)},{default:t(()=>[(c(!0),P($e,null,Fe(o(ae),(l,I)=>(c(),v(xe,{label:l.code,value:l.code,size:"large",key:I,border:""},{default:t(()=>[u("div",null,[u("div",Ze,[u("i",{class:Ne(l.icon)},null,2),g(K(l.name)+" ",1),e(O,null,{default:t(()=>[e(ye)]),_:1})])])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])])]),_:1})]),_:1}),e(De,{ref:"uploadRef",limit:1,accept:".xlsx,.xls,.ppt,.docx,.doc,.pdf,.pptx,.md",headers:f.headers,action:f.url+"?updateSupport="+f.updateSupport+"&datasetId="+o(C),disabled:f.isUploading,"on-progress":me,"on-success":fe,"auto-upload":!1,drag:""},{tip:t(()=>[u("div",tt,[u("div",lt,[e(Ve,{modelValue:f.updateSupport,"onUpdate:modelValue":a[13]||(a[13]=l=>f.updateSupport=l)},null,8,["modelValue"]),at]),ot,e(Ie,{type:"primary",underline:!1,style:{"font-size":"12px","vertical-align":"baseline"},onClick:ce},{default:t(()=>[g("\u81EA\u5B9A\u4E49\u6587\u4EF6\u5185\u5BB9\u6A21\u677F\u4E0B\u8F7D ")]),_:1})])]),default:t(()=>[e(O,{class:"el-icon--upload"},{default:t(()=>[e(Se)]),_:1}),et]),_:1},8,["headers","action","disabled"])]),_:1},8,["title","modelValue"])])}}}),rt=Ue(st,[["__scopeId","data-v-3ca59760"]]);export{rt as default};
