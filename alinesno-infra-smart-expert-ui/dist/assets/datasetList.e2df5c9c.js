import{B as he,_ as ke,m as xe,r as u,Q as B,T as Se,R as Re,a as n,H as Q,o as p,l as A,d as o,w as e,I as b,f as a,h as Ce,j as f,U as j,c as m,J as Ie,i as g,e as d,x as $,F as Ke,C as Ve,D as Ue,z as De,A as qe,n as ze}from"./index.2b31a27b.js";import{l as Te,d as $e}from"./roleKnowledge.bc6cf1cc.js";const R=k=>(De("data-v-7ea17025"),k=k(),qe(),k),Ne={style:{"padding-bottom":"30px"}},Fe=R(()=>d("div",{class:"role-icon",style:{"font-size":"20px"}},[d("i",{class:"fa-solid fa-file-pdf"})],-1)),Le={style:{"font-size":"15px","font-weight":"500","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis",color:"#3b5998"}},Pe={style:{"margin-bottom":"20px"}},Be={style:{padding:"10px"}},Qe=R(()=>d("div",{class:"el-upload__text"},[f("\u5C06\u6587\u4EF6\u62D6\u5230\u6B64\u5904\uFF0C\u6216"),d("em",null,"\u70B9\u51FB\u4E0A\u4F20")],-1)),Ae={class:"el-upload__tip text-center"},je={class:"el-upload__tip"},Ee=R(()=>d("span",null," \u662F\u5426\u66F4\u65B0\u5DF2\u7ECF\u5B58\u5728\u7684\u5E94\u7528\u6570\u636E ",-1)),He=R(()=>d("span",null,"\u652F\u6301 .txt, .doc, .docx, .pdf, .md \u6587\u4EF6\u3002",-1)),Je={class:"dialog-footer"},Me=he({name:"RoleKnowledge"}),Oe=Object.assign(Me,{setup(k,{expose:E}){xe();const{proxy:c}=ze(),x=u(""),N=u([]),H=u(!1),C=u(!0),S=u(!0),I=u([]),J=u(!0),M=u(!0),K=u(0),O=u(""),F=u([]),G=u([{id:"1",name:"\u6570\u636E\u96C6\u76F4\u63A5\u5206\u6BB5",icon:"fa-solid fa-file-word",type:"sp"},{id:"2",name:"\u6570\u636E\u96C6QA\u62C6\u5206",icon:"fa-brands fa-wordpress",type:"qa"},{id:"3",name:"CSV\u76F4\u63A5\u5BFC\u5165",icon:"fa-solid fa-file-import",type:"cvs"},{id:"4",name:"\u6570\u636E\u63A5\u53E3\u5BFC\u5165",icon:"fa-solid fa-file-word",type:"api"}]),i=B({open:!1,title:"",isUploading:!1,updateSupport:0,headers:{Authorization:"Bearer "+Se()},url:"/prod-api/api/infra/smart/assistant/roleKnowledge/importData"}),v=u([{key:0,label:"\u56FE\u6807",visible:!0},{key:1,label:"\u6570\u636E\u96C6\u540D\u79F0",visible:!0},{key:2,label:"\u6240\u6709\u8005",visible:!0},{key:3,label:"\u63CF\u8FF0\u4FE1\u606F",visible:!0},{key:4,label:"\u72B6\u6001",visible:!0},{key:5,label:"\u8BBF\u95EE\u6743\u9650",visible:!0},{key:6,label:"\u6570\u636E\u603B\u91CF",visible:!0},{key:7,label:"\u521B\u5EFA\u65F6\u95F4",visible:!0},{key:8,label:"\u7F16\u8F91",visible:!0}]),W=B({form:{},queryParams:{pageNum:1,pageSize:10,datasetId:""},rules:{datasetKnowledgeId:[{required:!0,message:"\u5E94\u7528\u7F16\u53F7\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],name:[{required:!0,message:"\u5E94\u7528\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},{min:2,max:20,message:"\u5E94\u7528\u540D\u79F0\u957F\u5EA6\u5FC5\u987B\u4ECB\u4E8E 2 \u548C 20 \u4E4B\u95F4",trigger:"blur"}],ownerId:[{required:!0,message:"\u663E\u793A\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],description:[{required:!0,message:"\u63CF\u8FF0\u4FE1\u606F\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],datasetStatus:[{required:!0,message:"\u57DF\u540D\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],accessPermission:[{required:!0,message:"\u5B89\u5168\u5B58\u50A8\u8DEF\u5F84\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],datasetSize:[{required:!0,message:"\u5E94\u7528\u76EE\u6807\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}}),{queryParams:r,form:V,rules:Ge}=Re(W);function w(){console.log("currentDatasetId = "+x.value),r.value.datasetId=x.value,C.value=!0,Te(c.addDateRange(r.value,F.value)).then(s=>{C.value=!1,N.value=s.rows,K.value=s.total})}function U(){console.log(r),r.value.pageNum=1,w()}function X(){F.value=[],c.resetForm("queryRef"),r.value.name=void 0,r.value.ownerId=void 0,c.$refs.deptTreeRef.setCurrentKey(null),U()}function Y(s){const l=s.id||I.value;c.$modal.confirm('\u662F\u5426\u786E\u8BA4\u5220\u9664\u5E94\u7528\u7F16\u53F7\u4E3A"'+l+'"\u7684\u6570\u636E\u9879\uFF1F').then(function(){return $e(l)}).then(()=>{w(),c.$modal.msgSuccess("\u5220\u9664\u6210\u529F")}).catch(()=>{})}function Z(s){I.value=s.map(l=>l.id),J.value=s.length!=1,M.value=!s.length}function ee(){V.value={datasetKnowledgeId:void 0,name:void 0,ownerId:void 0,description:void 0,datasetStatus:void 0,accessPermission:void 0,datasetSize:void 0},c.resetForm("RoleKnowledgeRef")}function te(s){ee();const l=s.id||I.value;getRoleKnowledge(l).then(h=>{V.value=h.data,V.value.datasetKnowledgeId=l,H.value=!0,O.value="\u4FEE\u6539\u5E94\u7528"})}function le(){i.title="\u6570\u636E\u96C6\u5BFC\u5165",i.open=!0}function oe(){c.download("system/user/importTemplate",{},`user_template_${new Date().getTime()}.xlsx`)}const ae=(s,l,h)=>{i.isUploading=!0},ne=(s,l,h)=>{i.open=!1,i.isUploading=!1,c.$refs.uploadRef.handleRemove(l),c.$alert("<div style='overflow: auto;overflow-x: hidden;max-height: 70vh;padding: 10px 20px 0;'>"+s.msg+"</div>","\u5BFC\u5165\u7ED3\u679C",{dangerouslyUseHTMLString:!0}),w()};function se(){c.$refs.uploadRef.submit()}function ie(s){x.value=s.knowledgeId,w()}return E({initRoleData:ie}),(s,l)=>{const h=n("el-input"),L=n("el-form-item"),_=n("el-button"),de=n("el-form"),D=n("el-col"),re=n("right-toolbar"),q=n("el-row"),y=n("el-table-column"),P=n("el-tooltip"),ue=n("el-table"),pe=n("pagination"),ce=n("el-radio"),me=n("el-radio-group"),fe=n("upload-filled"),_e=n("el-icon"),ge=n("el-checkbox"),ve=n("el-link"),we=n("el-upload"),ye=n("el-dialog"),z=Q("hasPermi"),be=Q("loading");return p(),A("div",Ne,[o(q,{gutter:20},{default:e(()=>[o(D,{span:24,xs:24},{default:e(()=>[b(o(de,{model:a(r),ref:"queryRef",inline:!0,"label-width":"100px"},{default:e(()=>[o(L,{label:"\u6570\u636E\u96C6\u540D\u79F0",prop:"name"},{default:e(()=>[o(h,{modelValue:a(r)["condition[name|like]"],"onUpdate:modelValue":l[0]||(l[0]=t=>a(r)["condition[name|like]"]=t),placeholder:"\u8BF7\u8F93\u5165\u5E94\u7528\u540D\u79F0",clearable:"",style:{width:"240px"},onKeyup:Ce(U,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),o(L,null,{default:e(()=>[o(_,{type:"primary",icon:"Search",onClick:U},{default:e(()=>[f("\u641C\u7D22")]),_:1}),o(_,{icon:"Refresh",onClick:X},{default:e(()=>[f("\u91CD\u7F6E")]),_:1})]),_:1})]),_:1},8,["model"]),[[j,a(S)]]),o(q,{gutter:10,class:"mb8"},{default:e(()=>[o(D,{span:1.5},{default:e(()=>[b((p(),m(_,{type:"primary",plain:"",icon:"Upload",onClick:le},{default:e(()=>[f("\u5BFC\u5165")]),_:1})),[[z,["system:user:import"]]])]),_:1},8,["span"]),o(re,{showSearch:a(S),"onUpdate:showSearch":l[1]||(l[1]=t=>Ie(S)?S.value=t:null),onQueryTable:w,columns:a(v)},null,8,["showSearch","columns"])]),_:1}),b((p(),m(ue,{data:a(N),onSelectionChange:Z},{default:e(()=>[o(y,{type:"selection",width:"50",align:"center"}),a(v)[0].visible?(p(),m(y,{key:0,label:"\u7C7B\u578B",align:"center",width:"80px",prop:"icon"},{default:e(t=>[Fe]),_:1})):g("",!0),a(v)[1].visible?(p(),m(y,{label:"\u6587\u6863\u540D\u79F0",align:"left",width:"300",key:"name",prop:"name","show-overflow-tooltip":!0},{default:e(t=>[d("div",Le,$(t.row.documentName),1)]),_:1})):g("",!0),a(v)[3].visible?(p(),m(y,{label:"\u6587\u6863\u63CF\u8FF0",align:"left",key:"description",prop:"description","show-overflow-tooltip":!0},{default:e(t=>[d("div",null,$(t.row.documentDesc),1)]),_:1})):g("",!0),a(v)[2].visible?(p(),m(y,{label:"\u6570\u636E\u6570\u91CF",align:"center",width:"130",key:"documentCount",prop:"documentCount","show-overflow-tooltip":!0})):g("",!0),a(v)[8].visible?(p(),m(y,{key:4,label:"\u64CD\u4F5C",align:"center",width:"150","class-name":"small-padding fixed-width"},{default:e(t=>[t.row.datasetKnowledgeId!==1?(p(),m(P,{key:0,content:"\u4FEE\u6539",placement:"top"},{default:e(()=>[b(o(_,{link:"",type:"primary",icon:"Edit",onClick:T=>te(t.row)},null,8,["onClick"]),[[z,["system:RoleKnowledge:edit"]]])]),_:2},1024)):g("",!0),t.row.datasetKnowledgeId!==1?(p(),m(P,{key:1,content:"\u5220\u9664",placement:"top"},{default:e(()=>[b(o(_,{link:"",type:"primary",icon:"Delete",onClick:T=>Y(t.row)},null,8,["onClick"]),[[z,["system:RoleKnowledge:remove"]]])]),_:2},1024)):g("",!0)]),_:1})):g("",!0)]),_:1},8,["data"])),[[be,a(C)]]),b(o(pe,{total:a(K),page:a(r).pageNum,"onUpdate:page":l[2]||(l[2]=t=>a(r).pageNum=t),limit:a(r).pageSize,"onUpdate:limit":l[3]||(l[3]=t=>a(r).pageSize=t),onPagination:w},null,8,["total","page","limit"]),[[j,a(K)>0]])]),_:1})]),_:1}),o(ye,{title:i.title,modelValue:i.open,"onUpdate:modelValue":l[7]||(l[7]=t=>i.open=t),width:"800px","append-to-body":""},{footer:e(()=>[d("div",Je,[o(_,{type:"primary",onClick:se},{default:e(()=>[f("\u786E \u5B9A")]),_:1}),o(_,{onClick:l[6]||(l[6]=t=>i.open=!1)},{default:e(()=>[f("\u53D6 \u6D88")]),_:1})])]),default:e(()=>[o(q,null,{default:e(()=>[o(D,{span:24},{default:e(()=>[d("div",Pe,[o(me,{modelValue:s.radio1,"onUpdate:modelValue":l[4]||(l[4]=t=>s.radio1=t)},{default:e(()=>[(p(!0),A(Ke,null,Ve(a(G),(t,T)=>(p(),m(ce,{label:t.type,size:"large",key:T},{default:e(()=>[d("div",Be,[d("div",null,[d("i",{class:Ue(t.icon)},null,2),f(" "+$(t.name),1)])])]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])])]),_:1})]),_:1}),o(we,{ref:"uploadRef",limit:1,accept:".xlsx,.xls,.ppt,.docx,.doc,.pdf,.pptx,.md",headers:i.headers,action:i.url+"?updateSupport="+i.updateSupport+"&datasetId="+a(x),disabled:i.isUploading,"on-progress":ae,"on-success":ne,"auto-upload":!1,drag:""},{tip:e(()=>[d("div",Ae,[d("div",je,[o(ge,{modelValue:i.updateSupport,"onUpdate:modelValue":l[5]||(l[5]=t=>i.updateSupport=t)},null,8,["modelValue"]),Ee]),He,o(ve,{type:"primary",underline:!1,style:{"font-size":"12px","vertical-align":"baseline"},onClick:oe},{default:e(()=>[f("\u81EA\u5B9A\u4E49\u6587\u4EF6\u5185\u5BB9\u6A21\u677F\u4E0B\u8F7D ")]),_:1})])]),default:e(()=>[o(_e,{class:"el-icon--upload"},{default:e(()=>[o(fe)]),_:1}),Qe]),_:1},8,["headers","action","disabled"])]),_:1},8,["title","modelValue"])])}}}),Ye=ke(Oe,[["__scopeId","data-v-7ea17025"]]);export{Ye as default};
