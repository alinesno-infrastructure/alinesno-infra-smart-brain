import{B as ee,r as i,Q as le,R as te,a as u,H as E,o as _,l as ae,I as g,U as ne,f as a,d as e,w as l,h as oe,j as m,c as v,J as Q,e as A,x as de,i as U,G as re,n as ue}from"./index.2b31a27b.js";import{l as F,a as se,g as pe,u as ie,b as me,d as ce}from"./catalog.898c48c0.js";const fe={class:"app-container"},_e={class:"dialog-footer"},he=ee({name:"Catalog"}),ye=Object.assign(he,{setup(ge){const{proxy:r}=ue();i([]);const R=i([]),c=i(!1),x=i(!0),C=i(!0),N=i(""),$=i([]),k=i(!0),I=i(!0),K=le({form:{},queryParams:{deptName:void 0,status:void 0},rules:{parentId:[{required:!0,message:"\u4E0A\u7EA7\u90E8\u95E8\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],deptName:[{required:!0,message:"\u90E8\u95E8\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],orderNum:[{required:!0,message:"\u663E\u793A\u6392\u5E8F\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],email:[{type:"email",message:"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u90AE\u7BB1\u5730\u5740",trigger:["blur","change"]}],phone:[{pattern:/^1[3|4|5|6|7|8|9][0-9]\d{8}$/,message:"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u624B\u673A\u53F7\u7801",trigger:"blur"}]}}),{queryParams:V,form:o,rules:j}=te(K);function h(){x.value=!0,F(V.value).then(d=>{console.log("response = "+d.data),console.log('proxy.handleTree(response.data, "deptId") = '+r.handleTree(d.data,"deptId")),R.value=r.handleTree(d.data,"deptId"),x.value=!1})}function L(){c.value=!1,T()}function T(){o.value={deptId:void 0,parentId:void 0,deptName:void 0,orderNum:0,leader:void 0,phone:void 0,email:void 0,status:"0"},r.resetForm("deptRef")}function S(){h()}function O(){r.resetForm("queryRef"),S()}function q(d){T(),F().then(t=>{$.value=r.handleTree(t.data,"deptId")}),d!=null&&(o.value.parentId=d.deptId),c.value=!0,N.value="\u6DFB\u52A0\u90E8\u95E8"}function G(){I.value=!1,k.value=!k.value,re(()=>{I.value=!0})}function H(d){T(),se(d.deptId).then(t=>{$.value=r.handleTree(t.data,"deptId")}),pe(d.deptId).then(t=>{o.value=t.data,c.value=!0,N.value="\u4FEE\u6539\u90E8\u95E8"})}function J(){r.$refs.deptRef.validate(d=>{d&&(o.value.deptId!=null?ie(o.value).then(t=>{r.$modal.msgSuccess("\u4FEE\u6539\u6210\u529F"),c.value=!1,h()}):me(o.value).then(t=>{r.$modal.msgSuccess("\u65B0\u589E\u6210\u529F"),c.value=!1,h()}))})}function z(d){r.$modal.confirm('\u662F\u5426\u786E\u8BA4\u5220\u9664\u540D\u79F0\u4E3A"'+d.deptName+'"\u7684\u6570\u636E\u9879?').then(function(){return ce(d.deptId)}).then(()=>{h(),r.$modal.msgSuccess("\u5220\u9664\u6210\u529F")}).catch(()=>{})}return h(),(d,t)=>{const b=u("el-input"),f=u("el-form-item"),s=u("el-button"),P=u("el-form"),p=u("el-col"),M=u("right-toolbar"),B=u("el-row"),y=u("el-table-column"),W=u("el-table"),X=u("el-input-number"),Y=u("el-dialog"),w=E("hasPermi"),Z=E("loading");return _(),ae("div",fe,[g(e(P,{model:a(V),ref:"queryRef",inline:!0},{default:l(()=>[e(f,{label:"\u90E8\u95E8\u540D\u79F0",prop:"deptName"},{default:l(()=>[e(b,{modelValue:a(V).deptName,"onUpdate:modelValue":t[0]||(t[0]=n=>a(V).deptName=n),placeholder:"\u8BF7\u8F93\u5165\u90E8\u95E8\u540D\u79F0",clearable:"",onKeyup:oe(S,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),e(f,null,{default:l(()=>[e(s,{type:"primary",icon:"Search",onClick:S},{default:l(()=>[m("\u641C\u7D22")]),_:1}),e(s,{icon:"Refresh",onClick:O},{default:l(()=>[m("\u91CD\u7F6E")]),_:1})]),_:1})]),_:1},8,["model"]),[[ne,a(C)]]),e(B,{gutter:10,class:"mb8"},{default:l(()=>[e(p,{span:1.5},{default:l(()=>[g((_(),v(s,{type:"primary",plain:"",icon:"Plus",onClick:q},{default:l(()=>[m("\u65B0\u589E")]),_:1})),[[w,["system:dept:add"]]])]),_:1},8,["span"]),e(p,{span:1.5},{default:l(()=>[e(s,{type:"info",plain:"",icon:"Sort",onClick:G},{default:l(()=>[m("\u5C55\u5F00/\u6298\u53E0")]),_:1})]),_:1},8,["span"]),e(M,{showSearch:a(C),"onUpdate:showSearch":t[1]||(t[1]=n=>Q(C)?C.value=n:null),onQueryTable:h},null,8,["showSearch"])]),_:1}),a(I)?g((_(),v(W,{key:0,data:a(R),"row-key":"deptId","default-expand-all":a(k),"tree-props":{children:"children",hasChildren:"hasChildren"}},{default:l(()=>[e(y,{prop:"deptName",label:"\u90E8\u95E8\u540D\u79F0"}),e(y,{prop:"orderNum",label:"\u6392\u5E8F",width:"200"}),e(y,{prop:"status",label:"\u72B6\u6001",width:"100"},{default:l(n=>[]),_:1}),e(y,{label:"\u521B\u5EFA\u65F6\u95F4",align:"center",prop:"createTime",width:"200"},{default:l(n=>[A("span",null,de(d.parseTime(n.row.createTime)),1)]),_:1}),e(y,{label:"\u64CD\u4F5C",align:"center",width:"250","class-name":"small-padding fixed-width"},{default:l(n=>[g((_(),v(s,{type:"text",icon:"Edit",onClick:D=>H(n.row)},{default:l(()=>[m("\u4FEE\u6539")]),_:2},1032,["onClick"])),[[w,["system:dept:edit"]]]),g((_(),v(s,{type:"text",icon:"Plus",onClick:D=>q(n.row)},{default:l(()=>[m("\u65B0\u589E")]),_:2},1032,["onClick"])),[[w,["system:dept:add"]]]),n.row.parentId!=0?g((_(),v(s,{key:0,type:"text",icon:"Delete",onClick:D=>z(n.row)},{default:l(()=>[m("\u5220\u9664")]),_:2},1032,["onClick"])),[[w,["system:dept:remove"]]]):U("",!0)]),_:1})]),_:1},8,["data","default-expand-all"])),[[Z,a(x)]]):U("",!0),e(Y,{title:a(N),modelValue:a(c),"onUpdate:modelValue":t[7]||(t[7]=n=>Q(c)?c.value=n:null),width:"600px","append-to-body":""},{footer:l(()=>[A("div",_e,[e(s,{type:"primary",onClick:J},{default:l(()=>[m("\u786E \u5B9A")]),_:1}),e(s,{onClick:L},{default:l(()=>[m("\u53D6 \u6D88")]),_:1})])]),default:l(()=>[e(P,{ref:"deptRef",model:a(o),rules:a(j),"label-width":"80px"},{default:l(()=>[e(B,null,{default:l(()=>[a(o).parentId!==0?(_(),v(p,{key:0,span:24})):U("",!0),e(p,{span:12},{default:l(()=>[e(f,{label:"\u90E8\u95E8\u540D\u79F0",prop:"deptName"},{default:l(()=>[e(b,{modelValue:a(o).deptName,"onUpdate:modelValue":t[2]||(t[2]=n=>a(o).deptName=n),placeholder:"\u8BF7\u8F93\u5165\u90E8\u95E8\u540D\u79F0"},null,8,["modelValue"])]),_:1})]),_:1}),e(p,{span:12},{default:l(()=>[e(f,{label:"\u663E\u793A\u6392\u5E8F",prop:"orderNum"},{default:l(()=>[e(X,{modelValue:a(o).orderNum,"onUpdate:modelValue":t[3]||(t[3]=n=>a(o).orderNum=n),"controls-position":"right",min:0},null,8,["modelValue"])]),_:1})]),_:1}),e(p,{span:12},{default:l(()=>[e(f,{label:"\u8D1F\u8D23\u4EBA",prop:"leader"},{default:l(()=>[e(b,{modelValue:a(o).leader,"onUpdate:modelValue":t[4]||(t[4]=n=>a(o).leader=n),placeholder:"\u8BF7\u8F93\u5165\u8D1F\u8D23\u4EBA",maxlength:"20"},null,8,["modelValue"])]),_:1})]),_:1}),e(p,{span:12},{default:l(()=>[e(f,{label:"\u8054\u7CFB\u7535\u8BDD",prop:"phone"},{default:l(()=>[e(b,{modelValue:a(o).phone,"onUpdate:modelValue":t[5]||(t[5]=n=>a(o).phone=n),placeholder:"\u8BF7\u8F93\u5165\u8054\u7CFB\u7535\u8BDD",maxlength:"11"},null,8,["modelValue"])]),_:1})]),_:1}),e(p,{span:12},{default:l(()=>[e(f,{label:"\u90AE\u7BB1",prop:"email"},{default:l(()=>[e(b,{modelValue:a(o).email,"onUpdate:modelValue":t[6]||(t[6]=n=>a(o).email=n),placeholder:"\u8BF7\u8F93\u5165\u90AE\u7BB1",maxlength:"50"},null,8,["modelValue"])]),_:1})]),_:1}),e(p,{span:12})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])])}}});export{ye as default};
