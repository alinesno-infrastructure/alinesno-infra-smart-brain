import{E as F,K as $e,B as ze,m as Fe,r as i,Q as Z,T as Ke,R as Pe,a as n,H as O,o as r,l as w,I as k,U as ee,f as a,d as e,w as l,h as te,j as c,J as Q,c as v,e as p,i as g,x as D,F as qe,C as Le,D as Ae,n as Be}from"./index.2b31a27b.js";var _="/api/infra/smart/assistant/template/",K={datatables:_+"datatables",createUrl:_+"add",saveUrl:_+"save",updateUrl:_+"modify",statusUrl:_+"changeStatus",cleanUrl:_+"clean",detailUrl:_+"detail",removeUrl:_+"delete",exportUrl:_+"exportExcel",changeField:_+"changeField",catalogTreeSelect:_+"catalogTreeSelect",downloadfile:_+"downloadfile"};function Ee(b){return F({url:K.datatables,method:"post",params:b})}function Oe(b){return F({url:K.saveUrl,method:"post",data:b})}function Qe(b){return F({url:K.updateUrl,method:"put",data:b})}function je(b){return F({url:K.removeUrl+"/"+$e(b),method:"delete"})}const He={class:"app-container"},Je={style:{"font-size":"1.6rem",color:"#3b5998"}},Me={key:0,class:"fa-solid fa-file-pdf"},Ge={key:1,class:"fa-regular fa-file-word"},We={key:2,class:"fa-solid fa-file-word"},Xe={key:3,class:"fa-solid fa-file-excel"},Ye={style:{"font-size":"13px",color:"#a5a5a5",cursor:"pointer"}},Ze={style:{"font-size":"13px",color:"#a5a5a5",cursor:"pointer"}},et={style:{"margin-bottom":"20px"}},tt={style:{padding:"10px"}},lt=p("div",{class:"el-upload__text"},[c("\u5C06\u6587\u4EF6\u62D6\u5230\u6B64\u5904\uFF0C\u6216"),p("em",null,"\u70B9\u51FB\u4E0A\u4F20")],-1),at={class:"el-upload__tip text-center"},ot={class:"el-upload__tip"},nt=p("span",null," \u662F\u5426\u66F4\u65B0\u5DF2\u7ECF\u5B58\u5728\u7684\u5E94\u7528\u6570\u636E ",-1),dt=p("span",null,"\u652F\u6301 .txt, .doc, .docx, .pdf, .md \u6587\u4EF6\u3002",-1),it={class:"dialog-footer"},rt={class:"dialog-footer"},st=ze({name:"Template"}),ut=Object.assign(st,{setup(b){Fe();const{proxy:u}=Be(),j=i([]),U=i(!1),le=i(""),ae=i(""),oe=i([]),R=i(!1),P=i(!0),I=i(!0),H=i([]),ne=i(!0),J=i(!0),q=i(0),de=i(""),M=i([]),ie=i(void 0);i([]),i([]);const N=i([{key:0,label:"\u6307\u4EE4\u540D\u79F0",visible:!0},{key:1,label:"\u6307\u4EE4\u63CF\u8FF0",visible:!0},{key:2,label:"\u8868\u6570\u636E\u91CF",visible:!0},{key:3,label:"\u7C7B\u578B",visible:!0},{key:4,label:"\u6307\u4EE4\u5730\u5740",visible:!0},{key:5,label:"\u72B6\u6001",visible:!0},{key:6,label:"\u66F4\u65B0\u65F6\u95F4",visible:!0}]),re=i([{id:"1",name:"\u6570\u636E\u96C6\u76F4\u63A5\u5206\u6BB5",icon:"fa-solid fa-file-word",type:"sp"},{id:"2",name:"\u6570\u636E\u96C6QA\u62C6\u5206",icon:"fa-brands fa-wordpress",type:"qa"},{id:"3",name:"CSV\u76F4\u63A5\u5BFC\u5165",icon:"fa-solid fa-file-import",type:"cvs"},{id:"4",name:"\u6570\u636E\u63A5\u53E3\u5BFC\u5165",icon:"fa-solid fa-file-word",type:"api"}]),s=Z({open:!1,title:"",isUploading:!1,updateSupport:0,headers:{Authorization:"Bearer "+Ke()},url:"/prod-api/api/infra/smart/assistant/template/importData"}),se=Z({form:{},queryParams:{pageNum:1,pageSize:10,templateName:void 0,promptDesc:void 0,catalogId:void 0},rules:{templateName:[{required:!0,message:"\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],dataSourceApi:[{required:!0,message:"\u8FDE\u63A5\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],promptType:[{required:!0,message:"\u7C7B\u578B\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],promptDesc:[{required:!0,message:"\u5907\u6CE8\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}}),{queryParams:f,form:m,rules:pe}=Pe(se);function h(){P.value=!0,Ee(u.addDateRange(f.value,M.value)).then(d=>{P.value=!1,j.value=d.rows,q.value=d.total})}function $(){f.value.pageNum=1,h()}function ue(){M.value=[],u.resetForm("queryRef"),f.value.catalogId=void 0,u.$refs.deptTreeRef.setCurrentKey(null),$()}function G(d){const o=d.id||H.value;u.$modal.confirm('\u662F\u5426\u786E\u8BA4\u5220\u9664\u6307\u4EE4\u7F16\u53F7\u4E3A"'+o+'"\u7684\u6570\u636E\u9879\uFF1F').then(function(){return je(o)}).then(()=>{h(),u.$modal.msgSuccess("\u5220\u9664\u6210\u529F")}).catch(()=>{})}function me(d){H.value=d.map(o=>o.id),ne.value=d.length!=1,J.value=!d.length}function ce(){m.value={id:void 0,deptId:void 0,TemplateName:void 0,nickName:void 0,password:void 0,phonenumber:void 0,status:"0",remark:void 0},u.resetForm("databaseRef")}function fe(){U.value=!1,R.value=!1,ce()}function _e(){s.title="\u6570\u636E\u96C6\u5BFC\u5165",s.open=!0}function ye(){u.download("system/user/importTemplate",{},`user_template_${new Date().getTime()}.xlsx`)}const ge=(d,o,T)=>{s.isUploading=!0},ve=(d,o,T)=>{s.open=!1,s.isUploading=!1,u.$refs.uploadRef.handleRemove(o),u.$alert("<div style='overflow: auto;overflow-x: hidden;max-height: 70vh;padding: 10px 20px 0;'>"+d.msg+"</div>","\u5BFC\u5165\u7ED3\u679C",{dangerouslyUseHTMLString:!0}),h()};function be(){u.$refs.uploadRef.submit()}function he(){u.$refs.databaseRef.validate(d=>{d&&(m.value.id!=null?Qe(m.value).then(o=>{u.$modal.msgSuccess("\u4FEE\u6539\u6210\u529F"),U.value=!1,h()}):Oe(m.value).then(o=>{u.$modal.msgSuccess("\u65B0\u589E\u6210\u529F"),U.value=!1,h()}))})}return h(),(d,o)=>{const T=n("el-input"),x=n("el-form-item"),y=n("el-button"),W=n("el-form"),V=n("el-col"),we=n("right-toolbar"),S=n("el-row"),C=n("el-table-column"),X=n("CopyDocument"),L=n("el-icon"),A=n("el-tooltip"),ke=n("el-table"),Te=n("pagination"),xe=n("TemplateEditor"),B=n("el-dialog"),Ve=n("el-radio"),Ue=n("el-radio-group"),Se=n("upload-filled"),Ce=n("el-checkbox"),Ne=n("el-link"),De=n("el-upload"),Re=n("el-tree-select"),Y=O("copyText"),E=O("hasPermi"),Ie=O("loading");return r(),w("div",He,[k(e(W,{model:a(f),ref:"queryRef",inline:!0,"label-width":"100px"},{default:l(()=>[e(x,{label:"\u6307\u4EE4\u540D\u79F0",prop:"templateName"},{default:l(()=>[e(T,{modelValue:a(f).templateName,"onUpdate:modelValue":o[0]||(o[0]=t=>a(f).templateName=t),placeholder:"\u8BF7\u8F93\u5165\u6307\u4EE4\u540D\u79F0",clearable:"",style:{width:"240px"},onKeyup:te($,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),e(x,{label:"\u6307\u4EE4\u540D\u79F0",prop:"templateName"},{default:l(()=>[e(T,{modelValue:a(f)["condition[templateName|like]"],"onUpdate:modelValue":o[1]||(o[1]=t=>a(f)["condition[templateName|like]"]=t),placeholder:"\u8BF7\u8F93\u5165\u6307\u4EE4\u540D\u79F0",clearable:"",style:{width:"240px"},onKeyup:te($,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),e(x,null,{default:l(()=>[e(y,{type:"primary",icon:"Search",onClick:$},{default:l(()=>[c("\u641C\u7D22")]),_:1}),e(y,{icon:"Refresh",onClick:ue},{default:l(()=>[c("\u91CD\u7F6E")]),_:1})]),_:1})]),_:1},8,["model"]),[[ee,a(I)]]),e(S,{gutter:10,class:"mb8"},{default:l(()=>[e(V,{span:1.5},{default:l(()=>[e(y,{type:"primary",plain:"",icon:"Plus",onClick:_e},{default:l(()=>[c("\u65B0\u589E")]),_:1})]),_:1},8,["span"]),e(V,{span:1.5},{default:l(()=>[e(y,{type:"danger",plain:"",icon:"Delete",disabled:a(J),onClick:G},{default:l(()=>[c("\u5220\u9664")]),_:1},8,["disabled"])]),_:1},8,["span"]),e(we,{showSearch:a(I),"onUpdate:showSearch":o[2]||(o[2]=t=>Q(I)?I.value=t:null),onQueryTable:h,columns:a(N)},null,8,["showSearch","columns"])]),_:1}),k((r(),v(ke,{data:a(j),onSelectionChange:me},{default:l(()=>[e(C,{type:"selection",width:"50",align:"center"}),a(N)[5].visible?(r(),v(C,{label:"\u56FE\u6807",align:"center",width:"60",key:"format",prop:"format"},{default:l(t=>[p("span",Je,[t.row.templateType=="pdf"?(r(),w("i",Me)):g("",!0),t.row.templateType=="xml"?(r(),w("i",Ge)):g("",!0),t.row.templateType=="docx"?(r(),w("i",We)):g("",!0),t.row.templateType=="xlsx"?(r(),w("i",Xe)):g("",!0)])]),_:1})):g("",!0),a(N)[0].visible?(r(),v(C,{label:"\u6587\u4EF6\u540D",align:"left",key:"templateName",prop:"templateName"},{default:l(t=>[p("div",null,D(t.row.templateName),1),k((r(),w("div",Ye,[c(" \u6807\u8BC6: "+D(t.row.id)+" ",1),e(L,null,{default:l(()=>[e(X)]),_:1})])),[[Y,t.row.id]])]),_:1})):g("",!0),a(N)[2].visible?(r(),v(C,{label:"\u6587\u4EF6Key",align:"center",key:"size",prop:"size","show-overflow-tooltip":!0},{default:l(t=>[k((r(),w("div",Ze,[c(D(t.row.templateKey)+" ",1),e(L,null,{default:l(()=>[e(X)]),_:1})])),[[Y,t.row.templateKey]])]),_:1})):g("",!0),a(N)[6].visible?(r(),v(C,{key:3,label:"\u4E0A\u4F20\u65F6\u95F4",align:"center",prop:"createTime",width:"160"},{default:l(t=>[p("span",null,D(d.parseTime(t.row.addTime)),1)]),_:1})):g("",!0),e(C,{label:"\u64CD\u4F5C",align:"center",width:"150","class-name":"small-padding fixed-width"},{default:l(t=>[t.row.TemplateId!==1?(r(),v(A,{key:0,content:"\u4E0B\u8F7D",placement:"top"},{default:l(()=>[k(e(y,{link:"",type:"primary",icon:"Download",onClick:z=>d.handleOpenLink(t.row)},null,8,["onClick"]),[[E,["system:Template:edit"]]])]),_:2},1024)):g("",!0),t.row.TemplateId!==1?(r(),v(A,{key:1,content:"\u6253\u5F00",placement:"top"},{default:l(()=>[k(e(y,{link:"",type:"primary",icon:"Link",onClick:z=>d.handleOpenLink(t.row)},null,8,["onClick"]),[[E,["system:Template:edit"]]])]),_:2},1024)):g("",!0),t.row.TemplateId!==1?(r(),v(A,{key:2,content:"\u5220\u9664",placement:"top"},{default:l(()=>[k(e(y,{link:"",type:"primary",icon:"Delete",onClick:z=>G(t.row)},null,8,["onClick"]),[[E,["system:Template:remove"]]])]),_:2},1024)):g("",!0)]),_:1})]),_:1},8,["data"])),[[Ie,a(P)]]),k(e(Te,{total:a(q),page:a(f).pageNum,"onUpdate:page":o[3]||(o[3]=t=>a(f).pageNum=t),limit:a(f).pageSize,"onUpdate:limit":o[4]||(o[4]=t=>a(f).pageSize=t),onPagination:h},null,8,["total","page","limit"]),[[ee,a(q)>0]]),e(B,{title:a(le),modelValue:a(R),"onUpdate:modelValue":o[5]||(o[5]=t=>Q(R)?R.value=t:null),width:"1024","destroy-on-close":"","append-to-body":""},{default:l(()=>[e(xe,{currentPostId:a(ae),currentTemplateContent:a(oe)},null,8,["currentPostId","currentTemplateContent"])]),_:1},8,["title","modelValue"]),e(B,{title:a(s).title,modelValue:a(s).open,"onUpdate:modelValue":o[9]||(o[9]=t=>a(s).open=t),width:"800px","append-to-body":""},{footer:l(()=>[p("div",it,[e(y,{type:"primary",onClick:be},{default:l(()=>[c("\u786E \u5B9A")]),_:1}),e(y,{onClick:o[8]||(o[8]=t=>a(s).open=!1)},{default:l(()=>[c("\u53D6 \u6D88")]),_:1})])]),default:l(()=>[e(S,null,{default:l(()=>[e(V,{span:24},{default:l(()=>[p("div",et,[e(Ue,{modelValue:d.radio1,"onUpdate:modelValue":o[6]||(o[6]=t=>d.radio1=t)},{default:l(()=>[(r(!0),w(qe,null,Le(a(re),(t,z)=>(r(),v(Ve,{label:t.type,size:"large",key:z},{default:l(()=>[p("div",tt,[p("div",null,[p("i",{class:Ae(t.icon)},null,2),c(" "+D(t.name),1)])])]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])])]),_:1})]),_:1}),e(De,{ref:"uploadRef",limit:1,accept:".xlsx,.xls,.ppt,.docx,.doc,.xml,.pptx,.md",headers:a(s).headers,action:a(s).url+"?updateSupport="+a(s).updateSupport+"&datasetId="+d.currentDatasetId,disabled:a(s).isUploading,"on-progress":ge,"on-success":ve,"auto-upload":!1,drag:""},{tip:l(()=>[p("div",at,[p("div",ot,[e(Ce,{modelValue:a(s).updateSupport,"onUpdate:modelValue":o[7]||(o[7]=t=>a(s).updateSupport=t)},null,8,["modelValue"]),nt]),dt,e(Ne,{type:"primary",underline:!1,style:{"font-size":"12px","vertical-align":"baseline"},onClick:ye},{default:l(()=>[c("\u81EA\u5B9A\u4E49\u6587\u4EF6\u5185\u5BB9\u6A21\u677F\u4E0B\u8F7D ")]),_:1})])]),default:l(()=>[e(L,{class:"el-icon--upload"},{default:l(()=>[e(Se)]),_:1}),lt]),_:1},8,["headers","action","disabled"])]),_:1},8,["title","modelValue"]),e(B,{title:a(de),modelValue:a(U),"onUpdate:modelValue":o[14]||(o[14]=t=>Q(U)?U.value=t:null),width:"900px","append-to-body":""},{footer:l(()=>[p("div",rt,[e(y,{type:"primary",onClick:he},{default:l(()=>[c("\u786E \u5B9A")]),_:1}),e(y,{onClick:fe},{default:l(()=>[c("\u53D6 \u6D88")]),_:1})])]),default:l(()=>[e(W,{model:a(m),rules:a(pe),ref:"databaseRef","label-width":"100px"},{default:l(()=>[e(S,null,{default:l(()=>[e(V,{span:24},{default:l(()=>[e(x,{style:{width:"100%"},label:"\u7C7B\u578B",prop:"promptType"},{default:l(()=>[e(Re,{modelValue:a(m).promptType,"onUpdate:modelValue":o[10]||(o[10]=t=>a(m).promptType=t),data:a(ie),props:{value:"id",label:"label",children:"children"},"value-key":"id",placeholder:"\u8BF7\u9009\u62E9\u5F52\u5C5E\u7C7B\u578B","check-strictly":""},null,8,["modelValue","data"])]),_:1})]),_:1})]),_:1}),e(S,null,{default:l(()=>[e(V,{span:24},{default:l(()=>[e(x,{label:"\u540D\u79F0",prop:"templateName"},{default:l(()=>[e(T,{modelValue:a(m).templateName,"onUpdate:modelValue":o[11]||(o[11]=t=>a(m).templateName=t),placeholder:"\u8BF7\u8F93\u5165\u6307\u4EE4\u540D\u79F0",maxlength:"50"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(S,null,{default:l(()=>[e(V,{span:24},{default:l(()=>[e(x,{label:"\u6570\u636E\u6765\u6E90",prop:"dataSourceApi"},{default:l(()=>[e(T,{modelValue:a(m).dataSourceApi,"onUpdate:modelValue":o[12]||(o[12]=t=>a(m).dataSourceApi=t),placeholder:"\u8BF7\u8F93\u5165dataSourceApi\u6570\u636E\u6765\u6E90",maxlength:"128"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(S,null,{default:l(()=>[e(V,{span:24},{default:l(()=>[e(x,{label:"\u5907\u6CE8",prop:"promptDesc"},{default:l(()=>[e(T,{modelValue:a(m).promptDesc,"onUpdate:modelValue":o[13]||(o[13]=t=>a(m).promptDesc=t),placeholder:"\u8BF7\u8F93\u5165\u6307\u4EE4\u5907\u6CE8"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])])}}});export{ut as default};
