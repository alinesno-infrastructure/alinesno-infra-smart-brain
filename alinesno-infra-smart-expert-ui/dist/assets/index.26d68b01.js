import{E as I,K as ie,_ as qe,B as ze,m as Be,r as p,Q as ae,T as Le,R as Ee,a as s,H as ne,o as d,l as oe,d as t,w as e,I as C,f as n,h as se,j as r,U as re,c as f,J as L,e as i,i as h,x as N,F as Ke,C as je,z as Me,A as Qe,n as Oe}from"./index.2b31a27b.js";import{l as He}from"./role.f35abc69.js";var u="/api/infra/smart/assistant/screen/",A={datatables:u+"datatables",createUrl:u+"add",saveUrl:u+"createScreen",updateUrl:u+"modify",statusUrl:u+"changeStatus",cleanUrl:u+"clean",detailUrl:u+"detail",removeUrl:u+"delete",removeScreen:u+"removeScreen",exportUrl:u+"exportExcel",changeField:u+"changeField",downloadFile:u+"downloadFile",createScreen:u+"createScreen",allMyScreen:u+"allMyScreen",allPublicScreen:u+"allPublicScreen",joinScreen:u+"joinScreen",getDefaultScreenId:u+"getDefaultScreenId",updateScreenAgent:u+"updateScreenAgent",closeScreenSSE:"/v1/api/infra/base/im/sseScreenTask/closeSseConnect",getFlowTaskNotice:"/v1/api/infra/base/im/chat/getFlowTaskNotice"};function Je(m,y){const D={screenId:m,rolesId:y};return I({url:A.updateScreenAgent,method:"post",data:D})}function Ge(m){return I({url:A.datatables,method:"post",params:m})}function We(m){return I({url:A.detailUrl+"/"+ie(m),method:"get"})}function Xe(m){return I({url:A.saveUrl,method:"post",data:m})}function Ye(m){return I({url:A.updateUrl,method:"put",data:m})}function Ze(m){return I({url:A.removeUrl+"/"+ie(m),method:"delete"})}const R=m=>(Me("data-v-17212348"),m=m(),Qe(),m),el={class:"app-container"},ll={class:"screen-icon"},tl=["src"],al={style:{"font-size":"15px","font-weight":"500",color:"#3b5998"}},nl={style:{"font-size":"13px",color:"#a5a5a5"}},ol=R(()=>i("i",{class:"fa-solid fa-user-shield"},null,-1)),sl=R(()=>i("i",{class:"fa-solid fa-user-ninja"},null,-1)),rl=R(()=>i("i",{class:"fa-solid fa-user-ninja"},null,-1)),il=R(()=>i("i",{class:"fa-solid fa-users-gear"},null,-1)),dl={class:"dialog-footer"},ul=R(()=>i("div",{class:"el-upload__text"},[r("\u5C06\u6587\u4EF6\u62D6\u5230\u6B64\u5904\uFF0C\u6216"),i("em",null,"\u70B9\u51FB\u4E0A\u4F20")],-1)),cl={class:"el-upload__tip text-center"},pl={class:"el-upload__tip"},ml=R(()=>i("span",null,"\u4EC5\u5141\u8BB8\u5BFC\u5165xls\u3001xlsx\u683C\u5F0F\u6587\u4EF6\u3002",-1)),fl={class:"dialog-footer"},_l={style:{"text-align":"center"}},gl={class:"dialog-footer"},vl=ze({name:"Screen"}),hl=Object.assign(vl,{setup(m){Be();const{proxy:y}=Oe(),D=p([]),S=p(!1),E=p(!0),$=p(!0),K=p([]),H=p(!0),J=p(!0),j=p(0),M=p(""),G=p([]),de=p(""),ue=[{id:"long_text",name:"\u5927\u6587\u672C"},{id:"leader_model",name:"\u7BA1\u7406\u8005"}],W=p([]),F=p(!1),ce=p(""),P=p([]),pe=p(0),_=ae({open:!1,title:"",isUploading:!1,updateSupport:0,headers:{Authorization:"Bearer "+Le()},url:"/prod-api/v1/api/infra/base/im/chat/importData"}),k=p([{key:0,label:"\u56FE\u6807",visible:!0},{key:1,label:"\u573A\u666F\u540D\u79F0",visible:!0},{key:2,label:"\u573A\u666F\u7C7B\u578B",visible:!0},{key:3,label:"\u4F7F\u7528\u573A\u666F",visible:!0},{key:4,label:"\u72B6\u6001",visible:!0},{key:5,label:"\u573A\u666F\u63CF\u8FF0",visible:!0},{key:6,label:"\u5E94\u7528\u76EE\u6807",visible:!0},{key:7,label:"\u521B\u5EFA\u65F6\u95F4",visible:!0},{key:8,label:"\u7F16\u8F91",visible:!0}]),me=ae({form:{},queryParams:{pageNum:1,pageSize:10,ScreenName:void 0,name:void 0,toolType:void 0,status:void 0,deptId:void 0},rules:{screenName:[{required:!0,message:"\u573A\u666F\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},{min:2,max:20,message:"\u573A\u666F\u540D\u79F0\u957F\u5EA6\u5FC5\u987B\u4ECB\u4E8E 2 \u548C 20 \u4E4B\u95F4",trigger:"blur"}],screenDesc:[{required:!0,message:"\u573A\u666F\u7C7B\u578B\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],screen:[{required:!0,message:"\u4F7F\u7528\u573A\u666F\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],hasStatus:[{required:!0,message:"\u72B6\u6001\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],description:[{required:!0,message:"\u573A\u666F\u63CF\u8FF0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],target:[{required:!0,message:"\u5E94\u7528\u76EE\u6807\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}}),{queryParams:g,form:v,rules:fe}=Ee(me);function w(){E.value=!0,Ge(y.addDateRange(g.value,G.value)).then(o=>{E.value=!1,D.value=o.rows,j.value=o.total})}function q(){console.log(g),g.value.pageNum=1,w()}const _e=(o,a)=>{de.value=URL.createObjectURL(a.raw),v.value.screenBanner=o.data},ge=o=>o.size/1024/1024>2?(ElMessage.error("Avatar picture size can not exceed 2MB!"),!1):!0;function ve(){G.value=[],y.resetForm("queryRef"),g.value.name=void 0,g.value.toolType=void 0,y.$refs.deptTreeRef.setCurrentKey(null),q()}function X(o){const a=o.id||K.value;y.$modal.confirm('\u662F\u5426\u786E\u8BA4\u5220\u9664\u5E94\u7528\u7F16\u53F7\u4E3A"'+a+'"\u7684\u6570\u636E\u9879\uFF1F').then(function(){return Ze(a)}).then(()=>{w(),y.$modal.msgSuccess("\u5220\u9664\u6210\u529F")}).catch(()=>{})}function he(o){K.value=o.map(a=>a.id),H.value=o.length!=1,J.value=!o.length}function Q(){v.value={applicationId:void 0,name:void 0,toolType:void 0,screen:void 0,hasStatus:void 0,description:void 0,target:void 0},y.resetForm("ScreenRef")}function ye(){S.value=!1,Q()}function be(){Q(),S.value=!0,M.value="\u6DFB\u52A0\u5E94\u7528"}function Y(o){Q();const a=o.id||K.value;We(a).then(b=>{v.value=b.data,v.value.applicationId=a,S.value=!0,M.value="\u4FEE\u6539\u5E94\u7528"})}function Se(){y.$refs.ScreenRef.validate(o=>{o&&(v.value.applicationId!=null?Ye(v.value).then(a=>{y.$modal.msgSuccess("\u4FEE\u6539\u6210\u529F"),S.value=!1,w()}):Xe(v.value).then(a=>{y.$modal.msgSuccess("\u65B0\u589E\u6210\u529F"),S.value=!1,w()}))})}function ke(){He().then(o=>{for(let a=0;a<o.data.length;a++){let b=o.data[a];W.value.push({key:b.id,label:b.roleName,disabled:!1})}})}function we(){F.value=!1,Je(pe.value,P.value).then(o=>{y.$modal.msgSuccess("\u66F4\u65B0\u6210\u529F"),w()})}const Ue=(o,a)=>a;return w(),ke(),(o,a)=>{const b=s("el-input"),x=s("el-form-item"),c=s("el-button"),Z=s("el-form"),U=s("el-col"),Ve=s("right-toolbar"),T=s("el-row"),V=s("el-table-column"),xe=s("el-switch"),ee=s("el-tooltip"),Ce=s("el-table"),Te=s("pagination"),Ie=s("Plus"),le=s("el-icon"),te=s("el-upload"),Ae=s("el-radio"),Re=s("el-radio-group"),O=s("el-dialog"),Fe=s("upload-filled"),Ne=s("el-checkbox"),De=s("el-link"),$e=s("el-transfer"),z=ne("hasPermi"),Pe=ne("loading");return d(),oe("div",el,[t(T,{gutter:20},{default:e(()=>[t(U,{span:24,xs:24},{default:e(()=>[C(t(Z,{model:n(g),ref:"queryRef",inline:!0,"label-width":"68px"},{default:e(()=>[t(x,{label:"\u573A\u666F\u540D\u79F0",prop:"name"},{default:e(()=>[t(b,{modelValue:n(g)["condition[name|like]"],"onUpdate:modelValue":a[0]||(a[0]=l=>n(g)["condition[name|like]"]=l),placeholder:"\u8BF7\u8F93\u5165\u573A\u666F\u540D\u79F0",clearable:"",style:{width:"240px"},onKeyup:se(q,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),t(x,{label:"\u573A\u666F\u7C7B\u578B",prop:"toolType","label-width":"100px"},{default:e(()=>[t(b,{modelValue:n(g)["condition[toolType|like]"],"onUpdate:modelValue":a[1]||(a[1]=l=>n(g)["condition[toolType|like]"]=l),placeholder:"\u8BF7\u8F93\u5165\u573A\u666F\u7C7B\u578B",clearable:"",style:{width:"240px"},onKeyup:se(q,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),t(x,null,{default:e(()=>[t(c,{type:"primary",icon:"Search",onClick:q},{default:e(()=>[r("\u641C\u7D22")]),_:1}),t(c,{icon:"Refresh",onClick:ve},{default:e(()=>[r("\u91CD\u7F6E")]),_:1})]),_:1})]),_:1},8,["model"]),[[re,n($)]]),t(T,{gutter:10,class:"mb8"},{default:e(()=>[t(U,{span:1.5},{default:e(()=>[t(c,{type:"primary",plain:"",icon:"Plus",onClick:be},{default:e(()=>[r("\u65B0\u589E ")]),_:1})]),_:1},8,["span"]),t(U,{span:1.5},{default:e(()=>[C((d(),f(c,{type:"success",plain:"",icon:"Edit",disabled:n(H),onClick:Y},{default:e(()=>[r("\u4FEE\u6539 ")]),_:1},8,["disabled"])),[[z,["system:Screen:edit"]]])]),_:1},8,["span"]),t(U,{span:1.5},{default:e(()=>[C((d(),f(c,{type:"danger",plain:"",icon:"Delete",disabled:n(J),onClick:X},{default:e(()=>[r("\u5220\u9664 ")]),_:1},8,["disabled"])),[[z,["system:Screen:remove"]]])]),_:1},8,["span"]),t(Ve,{showSearch:n($),"onUpdate:showSearch":a[2]||(a[2]=l=>L($)?$.value=l:null),onQueryTable:w,columns:n(k)},null,8,["showSearch","columns"])]),_:1}),C((d(),f(Ce,{data:n(D),onSelectionChange:he},{default:e(()=>[t(V,{type:"selection",width:"50",align:"center"}),n(k)[0].visible?(d(),f(V,{key:0,label:"\u56FE\u6807",align:"center",width:"100",prop:"screenBanner"},{default:e(l=>[i("div",ll,[i("img",{src:o.imagePath(l.row.screenBanner)},null,8,tl)])]),_:1})):h("",!0),n(k)[1].visible?(d(),f(V,{label:"\u573A\u666F\u540D\u79F0",align:"left",width:"250",key:"name",prop:"name","show-overflow-tooltip":!0},{default:e(l=>[i("div",al,N(l.row.screenName),1),i("div",nl," Key: "+N(l.row.id),1)]),_:1})):h("",!0),n(k)[5].visible?(d(),f(V,{label:"\u573A\u666F\u63CF\u8FF0",align:"left",key:"description",prop:"description","show-overflow-tooltip":!0},{default:e(l=>[i("div",null,N(l.row.screenDesc),1)]),_:1})):h("",!0),n(k)[2].visible?(d(),f(V,{label:"\u573A\u666F\u7C7B\u578B",align:"center",key:"screenType",width:"180",prop:"screenType","show-overflow-tooltip":!0},{default:e(l=>[l.row.screenType==1?(d(),f(c,{key:0,text:"",bg:"",type:"primary"},{default:e(()=>[ol,r("\xA0\u4E2A\u4EBA\u573A\u666F")]),_:1})):h("",!0),l.row.screenType==2?(d(),f(c,{key:1,text:"",bg:"",type:"danger"},{default:e(()=>[sl,r("\xA0\u79C1\u4EBA\u573A\u666F")]),_:1})):h("",!0),l.row.screenType==3?(d(),f(c,{key:2,text:"",bg:"",type:"success"},{default:e(()=>[rl,r("\xA0\u63A8\u8350\u573A\u666F")]),_:1})):h("",!0),l.row.screenType==9?(d(),f(c,{key:3,text:"",bg:"",type:"primary"},{default:e(()=>[il,r("\xA0\u516C\u5171\u573A\u666F")]),_:1})):h("",!0)]),_:1})):h("",!0),n(k)[1].visible?(d(),f(V,{label:"\u72B6\u6001",align:"center",width:"100",key:"hasStatus",prop:"hasStatus","show-overflow-tooltip":!0},{default:e(l=>[t(xe,{modelValue:l.row.hasStatus,"onUpdate:modelValue":B=>l.row.hasStatus=B,"active-value":0,"inactive-value":1,onChange:B=>o.handleChangStatusField("hasStatus",l.row.hasStatus,l.row.id)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1})):h("",!0),n(k)[7].visible?(d(),f(V,{key:5,label:"\u66F4\u65B0\u65F6\u95F4",align:"center",prop:"addTime",width:"160"},{default:e(l=>[i("span",null,N(o.parseTime(l.row.addTime)),1)]),_:1})):h("",!0),n(k)[8].visible?(d(),f(V,{key:6,label:"\u64CD\u4F5C",align:"center",width:"100","class-name":"small-padding fixed-width"},{default:e(l=>[l.row.applicationId!==1?(d(),f(ee,{key:0,content:"\u4FEE\u6539",placement:"top"},{default:e(()=>[C(t(c,{link:"",type:"primary",icon:"Edit",onClick:B=>Y(l.row)},null,8,["onClick"]),[[z,["system:Screen:edit"]]])]),_:2},1024)):h("",!0),l.row.applicationId!==1?(d(),f(ee,{key:1,content:"\u5220\u9664",placement:"top"},{default:e(()=>[C(t(c,{link:"",type:"primary",icon:"Delete",onClick:B=>X(l.row)},null,8,["onClick"]),[[z,["system:Screen:remove"]]])]),_:2},1024)):h("",!0)]),_:1})):h("",!0)]),_:1},8,["data"])),[[Pe,n(E)]]),C(t(Te,{total:n(j),page:n(g).pageNum,"onUpdate:page":a[3]||(a[3]=l=>n(g).pageNum=l),limit:n(g).pageSize,"onUpdate:limit":a[4]||(a[4]=l=>n(g).pageSize=l),onPagination:w},null,8,["total","page","limit"]),[[re,n(j)>0]])]),_:1})]),_:1}),t(O,{title:n(M),modelValue:n(S),"onUpdate:modelValue":a[8]||(a[8]=l=>L(S)?S.value=l:null),width:"900px","append-to-body":""},{footer:e(()=>[i("div",dl,[t(c,{type:"primary",onClick:Se},{default:e(()=>[r("\u786E \u5B9A")]),_:1}),t(c,{onClick:ye},{default:e(()=>[r("\u53D6 \u6D88")]),_:1})])]),default:e(()=>[t(Z,{model:n(v),rules:n(fe),ref:"ScreenRef","label-width":"80px"},{default:e(()=>[t(T,null,{default:e(()=>[t(U,{span:24,class:"editor-after-div"},{default:e(()=>[t(x,{label:"\u5934\u50CF",rules:[{required:!0,message:"\u8BF7\u4E0A\u4F20\u5934\u50CF",trigger:"blur"}]},{default:e(()=>[t(te,{"file-list":o.fileList,action:_.url+"?type=img&updateSupport="+_.updateSupport,"list-type":"picture-card","auto-upload":!0,limit:1,"on-success":_e,"before-upload":ge,headers:_.headers,disabled:_.isUploading,"on-progress":o.handleFileUploadProgress},{default:e(()=>[t(le,{class:"avatar-uploader-icon"},{default:e(()=>[t(Ie)]),_:1})]),_:1},8,["file-list","action","headers","disabled","on-progress"])]),_:1})]),_:1})]),_:1}),t(T,null,{default:e(()=>[t(U,{span:24},{default:e(()=>[t(x,{label:"\u573A\u666F\u7C7B\u578B",prop:"screenType"},{default:e(()=>[t(Re,{modelValue:n(v).screenType,"onUpdate:modelValue":a[5]||(a[5]=l=>n(v).screenType=l)},{default:e(()=>[(d(),oe(Ke,null,je(ue,l=>t(Ae,{key:l.id,value:l.id,label:l.id,size:"large"},{default:e(()=>[r(N(l.name),1)]),_:2},1032,["value","label"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(T,null,{default:e(()=>[t(U,{span:24},{default:e(()=>[t(x,{label:"\u573A\u666F\u540D\u79F0",prop:"screenName"},{default:e(()=>[t(b,{modelValue:n(v).screenName,"onUpdate:modelValue":a[6]||(a[6]=l=>n(v).screenName=l),placeholder:"\u8BF7\u8F93\u5165\u573A\u666F\u540D\u79F0",maxlength:"30"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(T,null,{default:e(()=>[t(U,{span:24},{default:e(()=>[t(x,{label:"\u573A\u666F\u63CF\u8FF0",prop:"screenDesc"},{default:e(()=>[t(b,{modelValue:n(v).screenDesc,"onUpdate:modelValue":a[7]||(a[7]=l=>n(v).screenDesc=l),placeholder:"\u8BF7\u8F93\u5165\u573A\u666F\u7C7B\u578B",maxlength:"350"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"]),t(O,{title:_.title,modelValue:_.open,"onUpdate:modelValue":a[11]||(a[11]=l=>_.open=l),width:"400px","append-to-body":""},{footer:e(()=>[i("div",fl,[t(c,{type:"primary",onClick:o.submitFileForm},{default:e(()=>[r("\u786E \u5B9A")]),_:1},8,["onClick"]),t(c,{onClick:a[10]||(a[10]=l=>_.open=!1)},{default:e(()=>[r("\u53D6 \u6D88")]),_:1})])]),default:e(()=>[t(te,{ref:"uploadRef",limit:1,accept:".xlsx, .xls",headers:_.headers,action:_.url+"?updateSupport="+_.updateSupport,disabled:_.isUploading,"on-progress":o.handleFileUploadProgress,"on-success":o.handleFileSuccess,"auto-upload":!1,drag:""},{tip:e(()=>[i("div",cl,[i("div",pl,[t(Ne,{modelValue:_.updateSupport,"onUpdate:modelValue":a[9]||(a[9]=l=>_.updateSupport=l)},null,8,["modelValue"]),r(" \u662F\u5426\u66F4\u65B0\u5DF2\u7ECF\u5B58\u5728\u7684\u5E94\u7528\u6570\u636E ")]),ml,t(De,{type:"primary",underline:!1,style:{"font-size":"12px","vertical-align":"baseline"},onClick:o.importTemplate},{default:e(()=>[r("\u4E0B\u8F7D\u6A21\u677F ")]),_:1},8,["onClick"])])]),default:e(()=>[t(le,{class:"el-icon--upload"},{default:e(()=>[t(Fe)]),_:1}),ul]),_:1},8,["headers","action","disabled","on-progress","on-success"])]),_:1},8,["title","modelValue"]),t(O,{modelValue:n(F),"onUpdate:modelValue":a[14]||(a[14]=l=>L(F)?F.value=l:null),title:n(ce),width:"50%"},{footer:e(()=>[i("div",gl,[t(c,{onClick:a[13]||(a[13]=l=>F.value=!1)},{default:e(()=>[r("\u5173\u95ED")]),_:1}),t(c,{type:"primary",onClick:we},{default:e(()=>[r("\u786E\u8BA4")]),_:1})])]),default:e(()=>[i("div",_l,[t($e,{modelValue:n(P),"onUpdate:modelValue":a[12]||(a[12]=l=>L(P)?P.value=l:null),filterable:"",style:{"text-align":"left",width:"100%",display:"inline-block"},titles:["\u6E90\u89D2\u8272","\u5DF2\u9009\u62E9"],format:{noChecked:"${total}",hasChecked:"${checked}/${total}"},"filter-method":Ue,"filter-placeholder":"\u641C\u7D22\u89D2\u8272",data:n(W)},null,8,["modelValue","data"])])]),_:1},8,["modelValue","title"])])}}}),Sl=qe(hl,[["__scopeId","data-v-17212348"]]);export{Sl as default};
