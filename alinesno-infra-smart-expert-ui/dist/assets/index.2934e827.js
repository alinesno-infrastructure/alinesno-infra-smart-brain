import{_ as ye,B as ve,m as ke,r as i,Q as we,R as he,a as p,H as Z,o as s,l as D,d as n,w as t,I as v,f as l,h as Ce,F as Te,C as xe,c as r,j as c,U as ee,J as h,e as C,i as d,x as T,n as Pe}from"./index.2b31a27b.js";import{_ as Se,l as Ve,d as Ie,g as Ne,r as Re}from"./prompt.da8e5911.js";import De from"./history.8a9f6349.js";const Ue={class:"app-container"},$e={class:"role-icon"},qe=["src"],Be={style:{"font-size":"13px",color:"#a5a5a5"}},ze={key:0},Fe={key:1},Ke={class:"dialog-footer"},Le=ve({name:"Task"}),Qe=Object.assign(Le,{setup(je){ke();const{proxy:g}=Pe(),{gen_status:te}=g.useDict("gen_status"),E=i([]),b=i(!1),U=i(!0),x=i(!0),$=i([]),H=i(!0),O=i(!0),q=i(0),P=i(""),A=i([]);i([]),i([]);const S=i(""),G=i(""),J=i(""),M=i(""),le=i([]),V=i(!1),I=i(!1),_=i([{key:0,label:"\u4EFB\u52A1\u540D\u79F0",visible:!0},{key:1,label:"\u4EFB\u52A1\u63CF\u8FF0",visible:!0},{key:2,label:"\u8868\u6570\u636E\u91CF",visible:!0},{key:3,label:"\u7C7B\u578B",visible:!0},{key:4,label:"\u4EFB\u52A1\u5730\u5740",visible:!0},{key:5,label:"\u72B6\u6001",visible:!0},{key:6,label:"\u66F4\u65B0\u65F6\u95F4",visible:!0}]),ne=we({form:{},queryParams:{pageNum:1,pageSize:10,dbName:void 0,genStatus:void 0,dbDesc:void 0},rules:{dbName:[{required:!0,message:"\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],jdbcUrl:[{required:!0,message:"\u8FDE\u63A5\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],dbType:[{required:!0,message:"\u7C7B\u578B\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],dbUsername:[{required:!0,message:"\u7528\u6237\u540D\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],dbPasswd:[{required:!0,message:"\u5BC6\u7801\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],dbDesc:[{required:!0,message:"\u5907\u6CE8\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}}),{queryParams:m,form:B,rules:Ee}=he(ne);function y(){U.value=!0,Ve(g.addDateRange(m.value,A.value)).then(o=>{U.value=!1,E.value=o.rows,q.value=o.total})}function z(){m.value.pageNum=1,y()}function ae(){A.value=[],g.resetForm("queryRef"),m.value.deptId=void 0,g.$refs.deptTreeRef.setCurrentKey(null),z()}function W(o){const a=o.id||$.value;g.$modal.confirm('\u662F\u5426\u786E\u8BA4\u5220\u9664\u4EFB\u52A1\u7F16\u53F7\u4E3A"'+a+'"\u7684\u6570\u636E\u9879\uFF1F').then(function(){return Ie(a)}).then(()=>{y(),g.$modal.msgSuccess("\u5220\u9664\u6210\u529F")}).catch(()=>{})}function oe(o){$.value=o.map(a=>a.id),H.value=o.length!=1,O.value=!o.length}function F(){B.value={id:void 0,deptId:void 0,TaskName:void 0,nickName:void 0,genStatus:void 0,phonenumber:void 0,status:"0",remark:void 0},g.resetForm("databaseRef")}function se(){b.value=!1,F()}function ie(){F(),b.value=!0,P.value="\u6DFB\u52A0\u4EFB\u52A1"}function X(o){F();const a=o.id||$.value;Ne(a).then(N=>{B.value=N.data,b.value=!0,P.value="\u4FEE\u6539\u4EFB\u52A1"})}function re(o){Re(o.id).then(a=>{g.$modal.msgSuccess("\u91CD\u7F6E\u6210\u529F."),y()})}function ue(o){b.value=!0,P.value=o.taskDesc,S.value=o.assistantContent}function de(o){G.value="\u67E5\u8BE2\u89D2\u8272\u53C2\u6570",V.value=!0,J.value=o.id}function pe(o){I.value=!0,M.value=o.id}return i(null),y(),(o,a)=>{const N=p("el-input"),R=p("el-form-item"),ce=p("el-option"),me=p("el-select"),u=p("el-button"),Y=p("el-form"),k=p("el-col"),fe=p("right-toolbar"),K=p("el-row"),f=p("el-table-column"),L=p("el-tooltip"),_e=p("el-table"),ge=p("pagination"),Q=p("el-dialog"),j=Z("hasPermi"),be=Z("loading");return s(),D("div",Ue,[n(K,{gutter:20},{default:t(()=>[n(k,{span:24,xs:24},{default:t(()=>[v(n(Y,{model:l(m),ref:"queryRef",inline:!0,"label-width":"100px"},{default:t(()=>[n(R,{label:"\u4EFB\u52A1\u540D\u79F0",prop:"dbName"},{default:t(()=>[n(N,{modelValue:l(m).dbName,"onUpdate:modelValue":a[0]||(a[0]=e=>l(m).dbName=e),placeholder:"\u8BF7\u8F93\u5165\u4EFB\u52A1\u540D\u79F0",clearable:"",style:{width:"240px"},onKeyup:Ce(z,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),n(R,{label:"\u4EFB\u52A1\u72B6\u6001",prop:"dbName"},{default:t(()=>[n(me,{modelValue:l(m).genStatus,"onUpdate:modelValue":a[1]||(a[1]=e=>l(m).genStatus=e),placeholder:"\u8BF7\u9009\u62E9\u4EFB\u52A1\u72B6\u6001",clearable:""},{default:t(()=>[(s(!0),D(Te,null,xe(l(te),e=>(s(),r(ce,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),n(R,null,{default:t(()=>[n(u,{type:"primary",icon:"Search",onClick:z},{default:t(()=>[c("\u641C\u7D22")]),_:1}),n(u,{icon:"Refresh",onClick:ae},{default:t(()=>[c("\u91CD\u7F6E")]),_:1})]),_:1})]),_:1},8,["model"]),[[ee,l(x)]]),n(K,{gutter:10,class:"mb8"},{default:t(()=>[n(k,{span:1.5},{default:t(()=>[n(u,{type:"primary",plain:"",icon:"Plus",onClick:ie},{default:t(()=>[c("\u65B0\u589E")]),_:1})]),_:1},8,["span"]),n(k,{span:1.5},{default:t(()=>[n(u,{type:"success",plain:"",icon:"Edit",disabled:l(H),onClick:X},{default:t(()=>[c("\u4FEE\u6539")]),_:1},8,["disabled"])]),_:1},8,["span"]),n(k,{span:1.5},{default:t(()=>[n(u,{type:"danger",plain:"",icon:"Delete",disabled:l(O),onClick:W},{default:t(()=>[c("\u5220\u9664")]),_:1},8,["disabled"])]),_:1},8,["span"]),n(fe,{showSearch:l(x),"onUpdate:showSearch":a[2]||(a[2]=e=>h(x)?x.value=e:null),onQueryTable:y,columns:l(_)},null,8,["showSearch","columns"])]),_:1}),v((s(),r(_e,{data:l(E),onSelectionChange:oe},{default:t(()=>[n(f,{type:"selection",width:"50",align:"center"}),l(_)[5].visible?(s(),r(f,{label:"\u56FE\u6807",align:"center",width:"50",key:"status"},{default:t(e=>[C("div",$e,[C("img",{src:"http://data.linesno.com/icons/circle/Delivery boy-"+((e.$index+1)%5+1)+".png"},null,8,qe)])]),_:1})):d("",!0),l(_)[0].visible?(s(),r(f,{label:"GPT\u89D2\u8272\u8BBE\u5B9A",align:"left",key:"systemContent",prop:"systemContent","show-overflow-tooltip":!0},{default:t(e=>[C("div",null,T(e.row.taskDesc),1),C("div",Be," \u4E1A\u52A1\u6807\u8BC6: "+T(e.row.businessId),1)]),_:1})):d("",!0),l(_)[2].visible?(s(),r(f,{label:"\u8BF7\u6C42\u53C2\u6570",align:"center",width:"120",key:"promptContent",prop:"promptContent","show-overflow-tooltip":!0},{default:t(e=>[n(u,{type:"primary",text:"",bg:"",icon:"Paperclip",onClick:w=>de(e.row)},{default:t(()=>[c("\u67E5\u770B")]),_:2},1032,["onClick"])]),_:1})):d("",!0),l(_)[2].visible?(s(),r(f,{label:"\u751F\u6210\u5185\u5BB9",align:"center",width:"150",key:"assistantContent",prop:"assistantContent","show-overflow-tooltip":!0},{default:t(e=>[n(u,{type:"primary",text:"",bg:"",icon:"Paperclip",onClick:w=>ue(e.row)},{default:t(()=>[c("\u67E5\u770B")]),_:2},1032,["onClick"])]),_:1})):d("",!0),l(_)[3].visible?(s(),r(f,{label:"\u91CD\u8BD5\u6B21\u6570",align:"center",key:"retryCount",width:"100",prop:"retryCount","show-overflow-tooltip":!0})):d("",!0),l(_)[3].visible?(s(),r(f,{label:"\u6D88\u8017\u65F6\u95F4",align:"center",key:"usageTime",width:"100",prop:"usageTime","show-overflow-tooltip":!0},{default:t(e=>[c(T(e.row.usageTime)+" \u79D2 ",1)]),_:1})):d("",!0),l(_)[1].visible?(s(),r(f,{label:"\u89D2\u8272\u6807\u8BC6",align:"center",width:"150px",key:"systemContent",prop:"systemContent","show-overflow-tooltip":!0},{default:t(e=>[n(u,{type:"primary",text:"",bg:"",icon:"Paperclip",onClick:w=>pe(e.row)},{default:t(()=>[c("\u751F\u6210\u5386\u53F2")]),_:2},1032,["onClick"])]),_:1})):d("",!0),l(_)[5].visible?(s(),r(f,{label:"\u4EFB\u52A1\u72B6\u6001",align:"center",width:"150",key:"taskStatus"},{default:t(e=>[e.row.taskStatus==0?(s(),r(u,{key:0,type:"info",text:"",bg:"",icon:"Paperclip"},{default:t(()=>[c("\u6392\u961F")]),_:1})):d("",!0),e.row.taskStatus==2?(s(),r(u,{key:1,type:"success",text:"",bg:"",icon:"Paperclip"},{default:t(()=>[c("\u6210\u529F")]),_:1})):d("",!0),e.row.taskStatus==1?(s(),r(u,{key:2,type:"primary",loading:"",text:"",bg:"",icon:"Loading"},{default:t(()=>[c("\u8FD0\u884C")]),_:1})):d("",!0),e.row.taskStatus==9?(s(),r(u,{key:3,type:"danger",text:"",bg:"",icon:"Paperclip"},{default:t(()=>[c("\u5931\u8D25")]),_:1})):d("",!0)]),_:1})):d("",!0),l(_)[6].visible?(s(),r(f,{key:8,label:"\u6700\u8FD1\u66F4\u65B0",align:"center",prop:"finishTime",width:"160"},{default:t(e=>[e.row.finishTime?(s(),D("span",ze,T(o.parseTime(e.row.finishTime)),1)):(s(),D("span",Fe,T(o.parseTime(e.row.updateTime)),1))]),_:1})):d("",!0),n(f,{label:"\u64CD\u4F5C",align:"center",width:"130","class-name":"small-padding fixed-width"},{default:t(e=>[e.row.TaskId!==1?(s(),r(L,{key:0,content:"\u91CD\u7F6E",placement:"top"},{default:t(()=>[v(n(u,{link:"",type:"primary",icon:"Position",onClick:w=>re(e.row)},null,8,["onClick"]),[[j,["system:Task:edit"]]])]),_:2},1024)):d("",!0),e.row.TaskId!==1?(s(),r(L,{key:1,content:"\u4FEE\u6539",placement:"top"},{default:t(()=>[v(n(u,{link:"",type:"primary",icon:"Edit",onClick:w=>X(e.row)},null,8,["onClick"]),[[j,["system:Task:edit"]]])]),_:2},1024)):d("",!0),e.row.TaskId!==1?(s(),r(L,{key:2,content:"\u5220\u9664",placement:"top"},{default:t(()=>[v(n(u,{link:"",type:"primary",icon:"Delete",onClick:w=>W(e.row)},null,8,["onClick"]),[[j,["system:Task:remove"]]])]),_:2},1024)):d("",!0)]),_:1})]),_:1},8,["data"])),[[be,l(U)]]),v(n(ge,{total:l(q),page:l(m).pageNum,"onUpdate:page":a[3]||(a[3]=e=>l(m).pageNum=e),limit:l(m).pageSize,"onUpdate:limit":a[4]||(a[4]=e=>l(m).pageSize=e),onPagination:y},null,8,["total","page","limit"]),[[ee,l(q)>0]])]),_:1})]),_:1}),n(Q,{title:l(G),modelValue:l(V),"onUpdate:modelValue":a[5]||(a[5]=e=>h(V)?V.value=e:null),width:"900px","destroy-on-close":"","append-to-body":""},{default:t(()=>[n(l(Se),{currentPostId:l(J),currentPromptContent:l(le)},null,8,["currentPostId","currentPromptContent"])]),_:1},8,["title","modelValue"]),n(Q,{title:"\u5185\u5BB9\u751F\u6210\u5386\u53F2",modelValue:l(I),"onUpdate:modelValue":a[6]||(a[6]=e=>h(I)?I.value=e:null),width:"900px","destroy-on-close":"","append-to-body":""},{default:t(()=>[n(l(De),{currentBusinessId:l(M)},null,8,["currentBusinessId"])]),_:1},8,["modelValue"]),n(Q,{title:l(P),modelValue:l(b),"onUpdate:modelValue":a[8]||(a[8]=e=>h(b)?b.value=e:null),width:"900px",labelPosition:o.top,"append-to-body":""},{footer:t(()=>[C("div",Ke,[n(u,{onClick:se},{default:t(()=>[c("\u53D6 \u6D88")]),_:1})])]),default:t(()=>[n(Y,{model:l(B),"label-width":"0px"},{default:t(()=>[n(K,null,{default:t(()=>[n(k,{span:24},{default:t(()=>[n(R,{prop:"currentTaskContent"},{default:t(()=>[n(N,{rows:"20",type:"textarea",modelValue:l(S),"onUpdate:modelValue":a[7]||(a[7]=e=>h(S)?S.value=e:null),placeholder:"\u8BF7\u8F93\u5165\u4EFB\u52A1\u540D\u79F0",maxlength:"50"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["title","modelValue","labelPosition"])])}}}),Ge=ye(Qe,[["__scopeId","data-v-d750bc69"]]);export{Ge as default};
