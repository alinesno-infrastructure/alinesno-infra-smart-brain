import{E as O,K as ce,B as pe,m as me,r,Q as j,T as fe,R as ge,a as c,H as Q,o as n,l as y,d as a,w as l,e as s,F as _e,C as be,f as t,x as b,j as h,I as x,h as W,U as H,J,c as p,i as u,n as he}from"./index.2b31a27b.js";import{l as we}from"./role.f35abc69.js";import ye from"./nodeRecord.fb05465a.js";var m="/api/infra/smart/assistant/workflowExecution/",G={datatables:m+"datatables",createUrl:m+"add",saveUrl:m+"save",updateUrl:m+"modify",statusUrl:m+"changeStatus",cleanUrl:m+"clean",detailUrl:m+"detail",removeUrl:m+"delete",exportUrl:m+"exportExcel",changeField:m+"changeField",downloadFile:m+"downloadFile"};function ve(S){return O({url:G.datatables,method:"post",params:S})}function ke(S){return O({url:G.removeUrl+"/"+ce(S),method:"delete"})}const xe={class:"app-container"},Se={class:"role-list-panel",style:{margin:"0px 0px"}},Ce=s("div",{class:"role-list-title"},[s("div",{style:{"font-size":"15px","margin-bottom":"15px",color:"#409EFF","font-weight":"bold"}},[s("i",{class:"fa-solid fa-user-secret"}),h(" \u5DE5\u7A0B\u5E08Agent\u5217\u8868 ")])],-1),Ne={class:"role-list-item"},Te={class:"item-box",style:{"list-style":"none",padding:"0px",margin:"0px"}},Ue={style:{float:"left","margin-right":"10px"}},Ae=["src"],Re={style:{width:"100%"}},Ve={style:{"line-height":"20px","margin-bottom":"5px","font-size":"15px"}},qe={style:{"font-size":"13px",color:"rgb(165, 165, 165)",cursor:"pointer"}},Ie={style:{float:"right"}},$e={class:"role-icon",style:{"font-size":"30px",color:"#3b5998"}},ze={key:0,class:"fa-brands fa-node-js"},Fe={key:1,class:"fa-brands fa-java"},De={key:2,class:"fa-brands fa-python"},Ee={style:{"font-size":"14px","font-weight":"500",color:"#3b5998"}},Ke={style:{"font-size":"12px",color:"#a5a5a5"}},Pe=pe({name:"Application"}),Je=Object.assign(Pe,{setup(S){me();const{proxy:v}=he(),I=r([]),k=r(!1),U=r(!0),C=r(!0),$=r([]),M=r(!0),X=r(!0),A=r(0),z=r(""),F=r([]),D=r(""),E=r([]);r(void 0),r(void 0),r([]),r([]),j({open:!1,title:"",isUploading:!1,updateSupport:0,headers:{Authorization:"Bearer "+fe()},url:"/prod-api/system/Application/importData"});const f=r([{key:0,label:"\u56FE\u6807",visible:!0},{key:1,label:"\u6D41\u7A0B\u540D\u79F0",visible:!0},{key:2,label:"\u663E\u793A\u540D\u79F0",visible:!0},{key:3,label:"\u6240\u5C5E\u9886\u57DF",visible:!0},{key:4,label:"\u57DF\u540D",visible:!0},{key:5,label:"\u5B89\u5168\u5B58\u50A8\u8DEF\u5F84",visible:!0},{key:6,label:"\u6D41\u7A0B\u76EE\u6807",visible:!0},{key:7,label:"\u521B\u5EFA\u65F6\u95F4",visible:!0},{key:8,label:"\u7F16\u8F91",visible:!0}]),Y=j({form:{},queryParams:{pageNum:1,pageSize:10,workflowName:"test",usageTimeSeconds:void 0,status:void 0,deptId:void 0},rules:{applicationId:[{required:!0,message:"\u6D41\u7A0B\u7F16\u53F7\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],workflowName:[{required:!0,message:"\u6D41\u7A0B\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},{min:2,max:20,message:"\u6D41\u7A0B\u540D\u79F0\u957F\u5EA6\u5FC5\u987B\u4ECB\u4E8E 2 \u548C 20 \u4E4B\u95F4",trigger:"blur"}],usageTimeSeconds:[{required:!0,message:"\u663E\u793A\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],workflowStatus:[{required:!0,message:"\u6240\u5C5E\u9886\u57DF\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],workflowStatus:[{required:!0,message:"\u57DF\u540D\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],id:[{required:!0,message:"\u5B89\u5168\u5B58\u50A8\u8DEF\u5F84\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],target:[{required:!0,message:"\u6D41\u7A0B\u76EE\u6807\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}}),{queryParams:d,form:Be,rules:Le}=ge(Y);function w(){U.value=!0,ve(v.addDateRange(d.value,F.value)).then(o=>{U.value=!1,I.value=o.rows,A.value=o.total})}function N(){console.log(d),d.value.pageNum=1,w()}function Z(){F.value=[],v.resetForm("queryRef"),d.value.workflowName=void 0,d.value.usageTimeSeconds=void 0,v.$refs.deptTreeRef.setCurrentKey(null),N()}function ee(o){const i=o.id||$.value;v.$modal.confirm('\u662F\u5426\u786E\u8BA4\u5220\u9664\u6D41\u7A0B\u7F16\u53F7\u4E3A"'+i+'"\u7684\u6570\u636E\u9879\uFF1F').then(function(){return ke(i)}).then(()=>{w(),v.$modal.msgSuccess("\u5220\u9664\u6210\u529F")}).catch(()=>{})}function te(o){d.value.roleId=o.id,w()}function le(o){$.value=o.map(i=>i.id),M.value=o.length!=1,X.value=!o.length}function K(o){k.value=!0,D.value=o.id,z.value="\u6D41\u7A0B\u5B50\u8282\u70B9"}function oe(){we().then(o=>{console.log("response = "+o),E.value=o.data})}return oe(),w(),(o,i)=>{const g=c("el-button"),ae=c("el-scrollbar"),R=c("el-col"),P=c("el-input"),V=c("el-form-item"),ne=c("el-form"),ie=c("right-toolbar"),q=c("el-row"),_=c("el-table-column"),B=c("el-tooltip"),re=c("el-table"),se=c("pagination"),de=c("el-dialog"),L=Q("hasPermi"),ue=Q("loading");return n(),y("div",xe,[a(q,{gutter:20},{default:l(()=>[a(R,{span:5,xs:24},{default:l(()=>[s("div",Se,[Ce,s("div",Ne,[a(ae,{height:"750px"},{default:l(()=>[s("ul",Te,[(n(!0),y(_e,null,be(t(E),(e,T)=>(n(),y("li",{class:"item-detail",style:{float:"left",width:"100%",background:"#fff",padding:"5px",display:"flex","border-radius":"2px","margin-bottom":"10px"},key:T},[s("div",Ue,[s("img",{src:o.imagePath(e.roleAvatar),style:{width:"45px",height:"45px","border-radius":"5px"}},null,8,Ae)]),s("div",Re,[s("div",Ve,b(o.truncateString(e.roleName,10)),1),s("div",qe,b(o.truncateString(e.responsibilities,20)),1)]),s("div",Ie,[a(g,{type:"primary",onClick:je=>te(e),text:"",bg:""},{default:l(()=>[h("\u9009\u62E9")]),_:2},1032,["onClick"])])]))),128))])]),_:1})])])]),_:1}),a(R,{span:19,xs:24},{default:l(()=>[a(q,{gutter:20},{default:l(()=>[a(R,{span:24,xs:24},{default:l(()=>[x(a(ne,{model:t(d),ref:"queryRef",inline:!0,"label-width":"68px"},{default:l(()=>[a(V,{label:"\u6D41\u7A0B\u540D\u79F0",prop:"workflowName"},{default:l(()=>[a(P,{modelValue:t(d)["condition[workflowName|like]"],"onUpdate:modelValue":i[0]||(i[0]=e=>t(d)["condition[workflowName|like]"]=e),placeholder:"\u8BF7\u8F93\u5165\u6D41\u7A0B\u540D\u79F0",clearable:"",style:{width:"240px"},onKeyup:W(N,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),a(V,{label:"\u663E\u793A\u540D\u79F0",prop:"usageTimeSeconds","label-width":"100px"},{default:l(()=>[a(P,{modelValue:t(d)["condition[usageTimeSeconds|like]"],"onUpdate:modelValue":i[1]||(i[1]=e=>t(d)["condition[usageTimeSeconds|like]"]=e),placeholder:"\u8BF7\u8F93\u5165\u663E\u793A\u540D\u79F0",clearable:"",style:{width:"240px"},onKeyup:W(N,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),a(V,null,{default:l(()=>[a(g,{type:"primary",icon:"Search",onClick:N},{default:l(()=>[h("\u641C\u7D22")]),_:1}),a(g,{icon:"Refresh",onClick:Z},{default:l(()=>[h("\u91CD\u7F6E")]),_:1})]),_:1})]),_:1},8,["model"]),[[H,t(C)]]),a(q,{gutter:10,class:"mb8"},{default:l(()=>[a(ie,{showSearch:t(C),"onUpdate:showSearch":i[2]||(i[2]=e=>J(C)?C.value=e:null),onQueryTable:w,columns:t(f)},null,8,["showSearch","columns"])]),_:1}),x((n(),p(re,{data:t(I),onSelectionChange:le},{default:l(()=>[a(_,{type:"selection",width:"50",align:"center"}),t(f)[0].visible?(n(),p(_,{key:0,label:"\u56FE\u6807",align:"center",width:"50px",prop:"icon"},{default:l(e=>[s("div",$e,[(e.$index+1)%3==2?(n(),y("i",ze)):u("",!0),(e.$index+1)%3==0?(n(),y("i",Fe)):u("",!0),(e.$index+1)%3==1?(n(),y("i",De)):u("",!0)])]),_:1})):u("",!0),t(f)[1].visible?(n(),p(_,{label:"\u6D41\u7A0B\u540D\u79F0",align:"left",key:"workflowName",prop:"workflowName","show-overflow-tooltip":!0},{default:l(e=>[s("div",Ee,b(e.row.id)+"#"+b(e.row.buildNumber),1),s("div",Ke," \u6267\u884C\u65F6\u95F4: "+b(e.row.usageTimeSeconds),1)]),_:1})):u("",!0),t(f)[3].visible?(n(),p(_,{label:"\u6267\u884C\u72B6\u6001",align:"center",key:"workflowStatus",prop:"workflowStatus",width:"100","show-overflow-tooltip":!0},{default:l(e=>[e.row.status==="Completed"?(n(),p(g,{key:0,type:"success",icon:o.CircleCheck,text:"",bg:""},{default:l(()=>[h("\u6210\u529F")]),_:1},8,["icon"])):u("",!0),e.row.status==="fail"?(n(),p(g,{key:1,type:"warning",icon:o.Warning,text:"",bg:""},{default:l(()=>[h("\u5931\u8D25")]),_:1},8,["icon"])):u("",!0)]),_:1})):u("",!0),t(f)[5].visible?(n(),p(_,{label:"\u6267\u884C\u8BB0\u5F55",align:"center",key:"id",prop:"id","show-overflow-tooltip":!0,width:"150"},{default:l(e=>[a(g,{type:"primary",onClick:T=>K(e.row),text:"",bg:"",icon:"Paperclip"},{default:l(()=>[h("\u67E5\u770B\u8BB0\u5F55")]),_:2},1032,["onClick"])]),_:1})):u("",!0),t(f)[7].visible?(n(),p(_,{key:4,label:"\u5F00\u59CB\u65F6\u95F4",align:"center",prop:"addTime",width:"160"},{default:l(e=>[s("span",null,b(o.parseTime(e.row.startTime)),1)]),_:1})):u("",!0),t(f)[7].visible?(n(),p(_,{key:5,label:"\u7ED3\u675F\u65F6\u95F4",align:"center",prop:"addTime",width:"160"},{default:l(e=>[s("span",null,b(o.parseTime(e.row.endTime)),1)]),_:1})):u("",!0),t(f)[8].visible?(n(),p(_,{key:6,label:"\u64CD\u4F5C",align:"center",width:"150","class-name":"small-padding fixed-width"},{default:l(e=>[e.row.applicationId!==1?(n(),p(B,{key:0,content:"\u4FEE\u6539",placement:"top"},{default:l(()=>[x(a(g,{link:"",type:"primary",icon:"Edit",onClick:T=>K(e.row)},null,8,["onClick"]),[[L,["system:Application:edit"]]])]),_:2},1024)):u("",!0),e.row.applicationId!==1?(n(),p(B,{key:1,content:"\u5220\u9664",placement:"top"},{default:l(()=>[x(a(g,{link:"",type:"primary",icon:"Delete",onClick:T=>ee(e.row)},null,8,["onClick"]),[[L,["system:Application:remove"]]])]),_:2},1024)):u("",!0)]),_:1})):u("",!0)]),_:1},8,["data"])),[[ue,t(U)]]),x(a(se,{total:t(A),page:t(d).pageNum,"onUpdate:page":i[3]||(i[3]=e=>t(d).pageNum=e),limit:t(d).pageSize,"onUpdate:limit":i[4]||(i[4]=e=>t(d).pageSize=e),onPagination:w},null,8,["total","page","limit"]),[[H,t(A)>0]])]),_:1})]),_:1})]),_:1})]),_:1}),t(k)?(n(),p(de,{key:0,title:t(z),modelValue:t(k),"onUpdate:modelValue":i[5]||(i[5]=e=>J(k)?k.value=e:null),width:"1024px","append-to-body":""},{default:l(()=>[a(t(ye),{currentWorkflowId:t(D)},null,8,["currentWorkflowId"])]),_:1},8,["title","modelValue"])):u("",!0)])}}});export{Je as default};
