import{_ as fe,r as n,B as me,a as h,C as ye,b as g,c as w,d as s,w as r,e as o,l as v,F as te,f as ae,y as U,u as i,G as oe,t as H,H as G,D as Ce,g as be,n as x,E as we,I as le,p as xe,i as ke,J as Ie}from"./index.d9d30be3.js";import{d as De,g as Se,c as ne,a as Ee,b as Pe,e as Re,f as Be,h as Ne}from"./generalAgent.c411e10f.js";import Ve from"./agentOutlineEditor.5206c73f.js";import Ae from"./agentContentDisplay.f3f31350.js";import Te from"./chatPanel.7a6ad93a.js";import"./index.23422e4c.js";import"./speaking.fcefe2d3.js";import"./userQuestionSuggestionsPanel.cb0efdab.js";import"./roleChat.91ed275b.js";import"./chatsse.0657b2ca.js";const P=k=>(xe("data-v-c7b090c7"),k=k(),ke(),k),ze={class:"app-container",style:{"background-color":"#fff","padding-top":"10px","padding-left":"0px !important"}},$e={class:"chapter-edit"},Ue={class:"card-header"},He={style:{display:"flex","align-items":"center",gap:"5px"}},Ge={class:"edit-header-avatar"},Le=["src","onClick"],Oe={class:"edit-header-avatar"},Me=["src"],Ke=P(()=>o("i",{class:"fa-solid fa-paper-plane"},null,-1)),qe=P(()=>o("i",{class:"fa-brands fa-firefox-browser"},null,-1)),Fe=P(()=>o("i",{class:"fa-solid fa-download"},null,-1)),Je={class:"user-info"},We=["src"],je={class:"chapter-tree-content"},Qe={class:"custom-tree-node",style:{height:"auto"}},Xe={style:{display:"flex","flex-direction":"column"}},Ye={style:{"font-size":"16px","font-weight":"bold",color:"#333"}},Ze={class:"description"},et={style:{color:"#777"}},tt={style:{"margin-right":"10px",display:"flex","align-items":"center",gap:"5px"}},at={class:"dialog-footer"},ot={class:"aip-flow-drawer"},lt={style:{"margin-top":"0px"}},nt={class:"document-wrapper"},st=["src"],rt={class:"word-download-button"},ct=P(()=>o("i",{class:"el-icon-download"},null,-1)),it={__name:"agentParser",setup(k){const L=be(),{proxy:O}=Ie(),u=n(!1),I=n(null),R=n(null),b=n(null),M=n(L.query.channelStreamId),_=n(L.query.sceneId),f=n(null),K=n(""),C=n(!1),B=n(null),p=n(null),N=n(null),V=n(0),D=n(!1),q=n(""),F=n(""),S=n(!1),J=n(null),A=n({}),E=n([]);n(!1);const W=n({roleAvatar:"",roleName:"\u5F20\u4E09",responsibilities:"\u4E3B\u8981\u8D1F\u8D23\u4E0E\u5BA2\u6237\u8FDB\u884C\u6C9F\u901A\uFF0C\u89E3\u7B54\u5BA2\u6237\u5173\u4E8E\u4EA7\u54C1\u7684\u5404\u79CD\u7591\u95EE\uFF0C\u63D0\u4F9B\u4E13\u4E1A\u7684\u54A8\u8BE2\u670D\u52A1\uFF0C\u4EE5\u5E2E\u52A9\u5BA2\u6237\u66F4\u597D\u5730\u7406\u89E3\u548C\u4F7F\u7528\u4EA7",email:"zhangsan@example.com"}),d=me({id:0,title:"",description:"",content:""}),se=(e,t)=>{u.value=!0,console.log("roleId = "+e+" , message = "+t),x(()=>{I.value.openChatBox(e,t),R.value.genStreamContentByMessage(e,t)})},re=async()=>{console.log("\u5F00\u59CB\u751F\u6210\u5168\u90E8\u7AE0\u8282\u5185\u5BB9\u901A\u8FC7\u89D2\u8272 = genChapterContentByAgent"),De(_.value).then(e=>{Se(_.value).then(t=>{Y(t.data),j(),u.value=!0})})},ce=async()=>{if(!d.id){we.error("\u8BF7\u5148\u9009\u62E9\u6307\u5B9A\u7AE0\u8282\uFF01");return}f.value=le.service({lock:!0,background:"rgba(255, 255, 255, 0.2)",customClass:"custom-loading"}),u.value=!0;let e="\u6B63\u5728\u91CD\u65B0\u751F\u6210\u3010"+d.title+"\u3011\u5185\u5BB9\uFF0C\u8BF7\u7A0D\u7B49.";f.value.setText(e);let t={sceneId:_.value,channelStreamId:M.value,chapterTitle:d.title,chapterDescription:d.description,chapterId:d.id};x(()=>{I.value.openChatBox(N.value,t.chapterTitle)});const l=await ne(t);b.value.setPlanItemContentData(l.data),f.value.close(),u.value=!1},j=async()=>{try{V.value=X(E.value),console.log("\u6587\u6863\u603B\u6570\u91CF = "+V.value);const e=[],t=l=>{for(let a of l)e.push(a),a.children&&a.children.length&&t(a.children)};t(E.value),f.value=le.service({lock:!0,background:"rgba(255, 255, 255, 0.5)",customClass:"custom-loading"}),u.value=!0;for(let l=0;l<e.length;l++){const a=e[l];console.log("\u8282\u70B9 = "+JSON.stringify(a)),console.log(`\u8282\u70B9 ${l+1}: ID = ${a.id}, Label = ${a.label}`);let T=` ${l+1}: \u7AE0\u8282:${a.label}`+" \u4EFB\u52A1\u751F\u6210\u4E2D\uFF0C\u8FD8\u6709\u3010"+(V.value-l)+"\u3011\u7BC7";f.value.setText(T),d.title=a.label,b.value.setPlanItem(a);let z={sceneId:_.value,channelStreamId:M.value,chapterTitle:a.label,chapterDescription:a.description,chapterId:a.id};x(()=>{console.log("--->> editorRoleId = "+a.chapterEditor),I.value.openChatBox(a.chapterEditor,a.label)});const $=await ne(z);b.value.setPlanItemContentData($.data)}}catch(e){console.error("Error fetching data:",e),O.$modal.msgError("\u751F\u6210\u5931\u8D25"),f.value.close()}f.value.close(),u.value=!1,Q()};function Q(){q.value="\u663E\u793A\u7ED3\u679C\u62A5\u544A\u5217\u8868",D.value=!0,S.value=!0,Ee(_.value).then(e=>{const t=e.data;J.value=t,x(async()=>{const l=await Pe(t);console.log("response.data:"+l),F.value=window.URL.createObjectURL(l),S.value=!1})})}const X=e=>{let t=0;for(let l of e)t++,l.children&&l.children.length&&(t+=X(l.children));return t},ie=(e,t)=>{N.value=e.data.chapterEditor,console.log("editorRoleId = "+N.value),d.id=t.id,d.title=e.label,d.chapterEditor=e.chapterEditor,d.description=e.data.description,b.value.setData(d)},de=e=>{K.value="\u8BF7\u9009\u62E9["+e.roleName+"]\u9700\u8981\u7F16\u8F91\u7684\u7AE0\u8282",W.value=e,W.value.email="zhangsan@example.com",p.value=e,p.value.selectedChapters=[],C.value=!0,x(()=>{Re(e.id,_.value).then(t=>{if(t.data){let l=t.data.map(a=>a.id);console.log("selectKey = "+l),B.value.setCheckedKeys(l)}})})},ue=()=>{const e=B.value.getCheckedNodes(!1,!0);console.log("newChapterIds= "+e);const t=e.map(a=>a.id);console.log("newChapterIds = "+t),p.value.selectedChapters=[...new Set([...p.value.selectedChapters,...t])],console.log("currentUser.value.selectedChapters="+p.value.selectedChapters);let l={sceneId:_.value,roleId:p.value.id,chapters:p.value.selectedChapters};Be(l).then(a=>{console.log(a),O.$modal.msgSuccess("\u5206\u914D\u6210\u529F"),C.value=!1,R.value.handleGetScene()})},pe=()=>{Ne(J.value).then(e=>{window.open(e.data)})},he=()=>{u.value=!1};function Y(e){A.value=e,E.value=e.chapterTree}return(e,t)=>{const l=h("el-col"),a=h("el-tooltip"),m=h("el-button"),T=h("el-card"),z=h("el-row"),$=h("el-avatar"),ge=h("el-tree"),Z=h("el-scrollbar"),ee=h("el-dialog"),ve=h("el-drawer"),_e=ye("loading");return g(),w("div",ze,[s(z,null,{default:r(()=>[s(l,{span:10},{default:r(()=>[s(Ve,{ref_key:"OutlineEditorRef",ref:R,onOpenChatBox:se,onHandleExecuteHandle:e.handleExecuteHandle,onHandleGetChannelStreamId:e.handleGetChannelStreamId,onCloseShowDebugRunDialog:he,onGenChapterContentByAgent:re,onSetCurrentSceneInfo:Y,onEditContent:ie},null,8,["onHandleExecuteHandle","onHandleGetChannelStreamId"])]),_:1}),s(l,{span:14},{default:r(()=>[o("div",$e,[s(T,{class:"box-card",shadow:"never"},{header:r(()=>[o("div",Ue,[o("div",He,[v(" \u4EFB\u52A1\u6267\u884C\u8282\u70B9 "),(g(!0),w(te,null,ae(i(A).businessExecuteEngineers,(c,y)=>(g(),U(a,{key:y,class:"box-item",effect:"dark",content:c.roleName,placement:"top"},{default:r(()=>[o("span",Ge,[o("img",{src:e.imagePathByPath(c.roleAvatar),onClick:dt=>de(c)},null,8,Le)])]),_:2},1032,["content"]))),128)),(g(!0),w(te,null,ae(i(A).dataViewerEngineers,(c,y)=>(g(),U(a,{key:y,class:"box-item",effect:"dark",content:c.roleName,placement:"top"},{default:r(()=>[o("span",Oe,[o("img",{src:e.imagePathByPath(c.roleAvatar)},null,8,Me)])]),_:2},1032,["content"]))),128))]),o("div",null,[s(m,{type:"primary",text:"",bg:"",size:"large",onClick:t[0]||(t[0]=c=>j())},{default:r(()=>[Ke,v(" \xA0 \u91CD\u65B0\u751F\u6210 ")]),_:1}),s(m,{type:"primary",text:"",bg:"",size:"large",onClick:t[1]||(t[1]=c=>ce())},{default:r(()=>[qe,v(" \xA0 \u751F\u6210\u7AE0\u8282 ")]),_:1}),s(m,{type:"primary",text:"",bg:"",size:"large",onClick:Q},{default:r(()=>[Fe,v(" \xA0 \u62A5\u544A\u751F\u6210 ")]),_:1})])])]),default:r(()=>[o("div",null,[s(Ae,{ref_key:"dataAnalysisDisplayRef",ref:b},null,512)])]),_:1})])]),_:1})]),_:1}),s(ee,{modelValue:i(C),"onUpdate:modelValue":t[3]||(t[3]=c=>G(C)?C.value=c:null),title:i(K),"append-to-body":"",width:"700px"},{default:r(()=>[o("div",Je,[i(p).roleAvatar?(g(),w("img",{key:0,class:"avatar",src:e.imagePathByPath(i(p).roleAvatar)},null,8,We)):oe("",!0),v(" \u89D2\u8272\u80FD\u529B: "+H(i(p).responsibilities),1)]),s(Z,{style:{height:"calc(100vh - 400px)"}},{default:r(()=>[o("div",je,[s(ge,{data:i(E),"node-key":"id","default-expand-all":"","show-checkbox":"","allow-drop":e.allowDrop,"allow-drag":e.allowDrag,onNodeClick:e.handleNodeClick,onNodeContextmenu:e.handleNodeContextMenu,"check-strictly":"",ref_key:"chapterSelectionTree",ref:B},{default:r(({node:c,data:y})=>[o("div",Qe,[o("div",Xe,[o("div",Ye,H(c.label),1),o("div",Ze,[o("span",et,H(y.description),1)])]),o("span",tt,[y.chapterEditor?(g(),U($,{key:0,size:20,src:e.imagePathByPath(y.chapterEditorAvatar)},null,8,["src"])):oe("",!0)])])]),_:1},8,["data","allow-drop","allow-drag","onNodeClick","onNodeContextmenu"])])]),_:1}),o("div",at,[s(m,{size:"large",onClick:t[2]||(t[2]=c=>C.value=!1)},{default:r(()=>[v("\u53D6 \u6D88")]),_:1}),s(m,{type:"primary",size:"large",onClick:ue},{default:r(()=>[v("\u786E \u5B9A")]),_:1})])]),_:1},8,["modelValue","title"]),o("div",ot,[s(ve,{modelValue:i(u),"onUpdate:modelValue":t[4]||(t[4]=c=>G(u)?u.value=c:null),modal:!1,size:"40%",style:{"max-width":"700px"},title:"\u9884\u89C8\u4E0E\u8C03\u8BD5","with-header":!0},{default:r(()=>[o("div",lt,[s(i(Te),{ref_key:"roleChatPanelRef",ref:I},null,512)])]),_:1},8,["modelValue"])]),s(ee,{modelValue:i(D),"onUpdate:modelValue":t[5]||(t[5]=c=>G(D)?D.value=c:null),title:i(q),width:"1300px","before-close":e.handleClosePdfDialog,"show-close":!0},{default:r(()=>[Ce((g(),w("div",nt,[s(Z,{class:"scrollable-area",style:{height:"calc(70vh)","margin-top":"20px","padding-right":"0px"}},{default:r(()=>[o("iframe",{src:i(F),style:{position:"absolute",width:"100%","border-radius":"5px",height:"100%",border:"0px","padding-bottom":"10px",background:"#323639"}},`
                `,8,st)]),_:1})])),[[_e,i(S)]]),o("div",rt,[s(m,{type:"primary",size:"large",loading:i(S),onClick:pe},{default:r(()=>[ct,v(" \u4E0B\u8F7DWord\u6587\u6863 ")]),_:1},8,["loading"])])]),_:1},8,["modelValue","title","before-close"])])}}},bt=fe(it,[["__scopeId","data-v-c7b090c7"]]);export{bt as default};
