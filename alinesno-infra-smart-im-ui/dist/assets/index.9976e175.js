import{_ as oe,r as o,B as ae,n as ne,a as i,b as x,c as $,d as t,w as a,e as n,u as c,G as B,l as m,t as b,y as se,H as w,g as ie,E as de,p as ce,i as re,J as pe}from"./index.d9d30be3.js";import{l as ue}from"./user.9e8a1ab9.js";import fe from"./examEditor.8cce7024.js";import _e from"./examQuestion.5d0efda6.js";import"./chatPanel.7a6ad93a.js";import"./index.23422e4c.js";import"./speaking.fcefe2d3.js";import"./userQuestionSuggestionsPanel.cb0efdab.js";import"./roleChat.91ed275b.js";import"./chatsse.0657b2ca.js";const f=g=>(ce("data-v-aa288072"),g=g(),re(),g),he={class:"app-container exam-screen-container",style:{"background-color":"#fff","padding-top":"10px"}},me={class:"chapter-edit"},ge={class:"card-header"},ve=f(()=>n("div",{style:{display:"flex","align-items":"center",gap:"5px","padding-left":"10px"}}," \u8BD5\u5377\u9884\u89C8 ",-1)),Ce=f(()=>n("i",{class:"fa-solid fa-feather icon-btn"},null,-1)),ye=f(()=>n("i",{class:"fa-solid fa-file-word icon-btn"},null,-1)),ke=f(()=>n("i",{class:"fa-solid fa-floppy-disk"},null,-1)),xe=f(()=>n("i",{class:"fa-solid fa-download"},null,-1)),be=f(()=>n("i",{class:"fa-brands fa-twitter"},null,-1)),we={class:"user-info"},Se=["src"],Ie={class:"chapter-tree-content"},Ee={class:"custom-tree-node",style:{height:"auto"}},Ne={style:{display:"flex","flex-direction":"column"}},Ve={style:{"font-size":"16px","font-weight":"bold",color:"#333"}},Ae={class:"description"},Ue={style:{color:"#777"}},Te={style:{"margin-right":"10px",display:"flex","align-items":"center",gap:"5px"}},ze={class:"dialog-footer"},Re={class:"dialog-body-content",style:{"text-align":"center"}},$e={class:"dialog-footer"},Be={__name:"index",setup(g){const S=ie(),{proxy:D}=pe(),I=o([]),O=o(""),v=o(!1),C=o([]);o("chapter");const E=o([]);o(!1),o(null),o(""),o("");const N=o(null),P=o(!1),M=o(""),_=o(!1),V=o(null),p=o(null);o({roleAvatar:"",roleName:"\u5F20\u4E09",responsibilities:"\u4E3B\u8981\u8D1F\u8D23\u4E0E\u5BA2\u6237\u8FDB\u884C\u6C9F\u901A\uFF0C\u89E3\u7B54\u5BA2\u6237\u5173\u4E8E\u4EA7\u54C1\u7684\u5404\u79CD\u7591\u95EE\uFF0C\u63D0\u4F9B\u4E13\u4E1A\u7684\u54A8\u8BE2\u670D\u52A1\uFF0C\u4EE5\u5E2E\u52A9\u5BA2\u6237\u66F4\u597D\u5730\u7406\u89E3\u548C\u4F7F\u7528\u4EA7",email:"zhangsan@example.com"});const A=o(null),U=o(null),F=o(null);o(null);const T=o(S.query.screenId);o(0);const u=ae({id:0,title:"",content:""}),y=o([]),L=()=>{console.log("\u63D0\u4EA4\u7684\u6570\u636E:",u);let e={id:u.id,title:u.title,content:A.value.getData()};updateChapterContent(e).then(l=>{de.success("\u4FDD\u5B58"+u.title+"\u6210\u529F\uFF01")})};function Q(){uploadOss(T.value).then(e=>{window.open(e.data)})}function q(){U.value.handleOpenUpload(!0)}const G=()=>{N.value.toggleEditMode()};function J(e){I.value=e,y.value=e.chapterTree}function H(){ue().then(e=>{for(let l=0;l<e.data.length;l++){let r=e.data[l];E.value.push({key:r.id,label:r.roleName,disabled:!1})}})}const j=(e,l)=>{console.log("node = "+e),console.log("data = "+l);let r=l.id;u.id=l.id,u.title=e.label,getChapterContent(r).then(s=>{console.log("res = "+JSON.stringify(s)),A.value.setData(s.data),P.value=!1})},K=()=>{const e=V.value.getCheckedNodes(!1,!0);console.log("newChapterIds= "+e);const l=e.map(s=>s.id);console.log("newChapterIds = "+l),p.value.selectedChapters=[...new Set([...p.value.selectedChapters,...l])],console.log("currentUser.value.selectedChapters="+p.value.selectedChapters);let r={screenId:T.value,roleId:p.value.id,chapters:p.value.selectedChapters};updateChapterContentEditor(r).then(s=>{console.log(s),D.$modal.msgSuccess("\u5206\u914D\u6210\u529F"),_.value=!1,z()})};function z(){getScreen(currentScreenId.value).then(e=>{I.value=e.data,y.value=e.data.chapterTree})}return ne(()=>{console.log("screenId = "+S.query.screenId),H(),z()}),(e,l)=>{const r=i("el-col"),s=i("el-button"),h=i("el-tooltip"),W=i("el-card"),X=i("el-row"),Y=i("el-avatar"),Z=i("el-tree"),ee=i("el-scrollbar"),R=i("el-dialog"),te=i("ScreenUploadFile"),le=i("el-transfer");return x(),$("div",he,[t(X,null,{default:a(()=>[t(r,{span:10},{default:a(()=>[t(fe,{ref_key:"OutlineEditorRef",ref:F,onSetCurrentScreenInfo:J,onEditContent:j},null,512)]),_:1}),t(r,{span:14},{default:a(()=>[n("div",me,[t(W,{class:"box-card",shadow:"never"},{header:a(()=>[n("div",ge,[ve,n("div",null,[t(h,{class:"box-item",effect:"dark",content:"\u7F16\u8F91\u8BD5\u5377",placement:"top"},{default:a(()=>[t(s,{type:"primary",text:"",bg:"",size:"large",onClick:l[0]||(l[0]=d=>G())},{default:a(()=>[Ce]),_:1})]),_:1}),t(h,{class:"box-item",effect:"dark",content:"\u4E0A\u4F20\u6587\u6863\u6587\u4EF6",placement:"top"},{default:a(()=>[t(s,{type:"danger",text:"",bg:"",size:"large",onClick:q},{default:a(()=>[ye]),_:1})]),_:1}),t(h,{class:"box-item",effect:"dark",content:"\u4FDD\u5B58\u7AE0\u8282",placement:"top"},{default:a(()=>[t(s,{type:"primary",text:"",bg:"",size:"large",onClick:L},{default:a(()=>[ke]),_:1})]),_:1}),t(h,{class:"box-item",effect:"dark",content:"\u5BFC\u51FA\u6587\u6863",placement:"top"},{default:a(()=>[t(s,{type:"primary",text:"",bg:"",size:"large",onClick:Q},{default:a(()=>[xe]),_:1})]),_:1}),t(h,{class:"box-item",effect:"dark",content:"\u5206\u4EAB\u8BD5\u5377",placement:"top"},{default:a(()=>[t(s,{type:"primary",text:"",bg:"",size:"large",onClick:e.shareExam},{default:a(()=>[be]),_:1},8,["onClick"])]),_:1})])])]),default:a(()=>[t(_e,{ref_key:"examQuestionRef",ref:N},null,512)]),_:1})])]),_:1})]),_:1}),t(R,{modelValue:c(_),"onUpdate:modelValue":l[2]||(l[2]=d=>w(_)?_.value=d:null),title:c(M),"append-to-body":"",width:"700px"},{default:a(()=>[n("div",we,[c(p).roleAvatar?(x(),$("img",{key:0,class:"avatar",src:e.imagePathByPath(c(p).roleAvatar)},null,8,Se)):B("",!0),m(" \u89D2\u8272\u80FD\u529B: "+b(c(p).responsibilities),1)]),t(ee,{style:{height:"calc(100vh - 400px)"}},{default:a(()=>[n("div",Ie,[t(Z,{data:c(y),"node-key":"id","default-expand-all":"","show-checkbox":"","allow-drop":e.allowDrop,"allow-drag":e.allowDrag,onNodeClick:e.handleNodeClick,onNodeContextmenu:e.handleNodeContextMenu,"check-strictly":"",ref_key:"chapterSelectionTree",ref:V},{default:a(({node:d,data:k})=>[n("div",Ee,[n("div",Ne,[n("div",Ve,b(d.label),1),n("div",Ae,[n("span",Ue,b(k.description),1)])]),n("span",Te,[k.chapterEditor?(x(),se(Y,{key:0,size:20,src:e.imagePathByPath(k.chapterEditorAvatar)},null,8,["src"])):B("",!0)])])]),_:1},8,["data","allow-drop","allow-drag","onNodeClick","onNodeContextmenu"])])]),_:1}),n("div",ze,[t(s,{onClick:l[1]||(l[1]=d=>_.value=!1)},{default:a(()=>[m("\u53D6 \u6D88")]),_:1}),t(s,{type:"primary",onClick:K},{default:a(()=>[m("\u786E \u5B9A")]),_:1})])]),_:1},8,["modelValue","title"]),t(te,{ref_key:"uploadChildComp",ref:U},null,512),t(R,{modelValue:c(v),"onUpdate:modelValue":l[5]||(l[5]=d=>w(v)?v.value=d:null),title:c(O),width:"900"},{footer:a(()=>[n("div",$e,[t(s,{onClick:l[4]||(l[4]=d=>v.value=!1)},{default:a(()=>[m("\u5173\u95ED")]),_:1}),t(s,{type:"primary",onClick:e.handleCloseAgentConfig},{default:a(()=>[m("\u786E\u8BA4")]),_:1},8,["onClick"])])]),default:a(()=>[n("div",Re,[t(le,{modelValue:c(C),"onUpdate:modelValue":l[3]||(l[3]=d=>w(C)?C.value=d:null),filterable:"",style:{"text-align":"left",width:"100%",display:"inline-block"},titles:["\u6E90\u89D2\u8272","\u5DF2\u9009\u62E9"],format:{noChecked:"${total}",hasChecked:"${checked}/${total}"},"filter-method":e.filterAgentMethod,"filter-placeholder":"\u641C\u7D22\u89D2\u8272",data:c(E)},null,8,["modelValue","filter-method","data"])])]),_:1},8,["modelValue","title"])])}}},He=oe(Be,[["__scopeId","data-v-aa288072"]]);export{He as default};
