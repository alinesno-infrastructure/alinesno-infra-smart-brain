import{_ as te,g as ae,r as s,B,j as oe,o as ne,a as c,C as se,b as d,c as b,e as i,d as a,w as o,F as S,f as x,y,l as w,G as re,D as ue,I as j,n as ce,p as ie,i as de}from"./index.d9d30be3.js";import"./docx-preview.7258dbdc.js";import{r as pe,c as me,b as ve,d as ge,g as _e,e as be}from"./contentFormatter.0bc48627.js";const g=f=>(ie("data-v-c5b60826"),f=f(),de(),f),fe={class:"contract-review-container"},he={class:"review-methods-container"},ye=g(()=>i("div",{class:"review-methods-title"},"\u6392\u7248\u65B9\u5F0F",-1)),we={class:"form-container"},ke=g(()=>i("i",{class:"fa-solid fa-rocket"},null,-1)),Re=g(()=>i("i",{class:"fa-solid fa-train-subway"},null,-1)),Ie=g(()=>i("span",{style:{"font-size":"13px"}},"\u5185\u5BB9\u68C0\u67E5",-1)),Ce={class:"gen-overview-container",style:{"margin-top":"10px",display:"flex","justify-content":"space-between","margin-right":"10px","margin-left":"10px"}},Se=g(()=>i("i",{class:"fa-solid fa-hands-clapping"},null,-1)),xe=g(()=>i("i",{class:"fa-solid fa-paper-plane"},null,-1)),Ve={class:"document-wrapper"},Le=["src"],Te={class:"document-footer"},Oe=g(()=>i("i",{class:"fa-solid fa-sailboat"},null,-1)),De={__name:"overview",props:{currentSceneInfo:{type:Object,default:()=>{}}},emits:["handleStepClick","displayDocumentReviewList","getContentPromptContent","genSingleChapterContent"],setup(f,{emit:_}){const k=f,q=ae(),E=s(q.query.channelStreamId);s(q.query.sceneId),s({});const V=s(),v=s(null);s(null),s(!1);const P=s(null),L=s(!1),A=s([{value:"government",label:"\u653F\u52A1"},{value:"commerce",label:"\u5546\u52A1"},{value:"ecommerce",label:"\u7535\u5546"},{value:"campus",label:"\u6821\u56ED"},{value:"medical",label:"\u533B\u7597"},{value:"education",label:"\u6559\u80B2"},{value:"finance",label:"\u91D1\u878D"},{value:"manufacturing",label:"\u5236\u9020"},{value:"media",label:"\u5A92\u4F53"},{value:"entertainment",label:"\u5A31\u4E50"},{value:"transportation",label:"\u4EA4\u901A"},{value:"agriculture",label:"\u519C\u4E1A"},{value:"construction",label:"\u5EFA\u7B51"},{value:"energy",label:"\u80FD\u6E90"},{value:"tourism",label:"\u65C5\u6E38"},{value:"service",label:"\u670D\u52A1"}]),T=s([]),G=s([{value:"notice",label:"\u901A\u77E5"},{value:"government_letter",label:"\u653F\u52A1\u51FD"},{value:"red_head_document",label:"\u7EA2\u5934\u6587\u4EF6"},{value:"report",label:"\u62A5\u544A"},{value:"memo",label:"\u5907\u5FD8\u5F55"},{value:"contract",label:"\u5408\u540C"},{value:"agreement",label:"\u534F\u8BAE"},{value:"proposal",label:"\u63D0\u6848"},{value:"announcement",label:"\u516C\u544A"},{value:"circular",label:"\u901A\u62A5"},{value:"invitation",label:"\u9080\u8BF7\u51FD"},{value:"declaration",label:"\u58F0\u660E"},{value:"application",label:"\u7533\u8BF7\u4E66"},{value:"resume",label:"\u7B80\u5386"}]),O=s(!0);s(null);const N=s(null),e=B({reviewListOption:"dataset",documentType:[],businessScenario:[],templateId:""}),z=s([]),J=B({documentType:[{required:!0,message:"\u8BF7\u9009\u62E9\u6587\u7A3F\u7C7B\u578B",trigger:"change"}],businessScenario:[{required:!0,message:"\u8BF7\u9009\u62E9\u4E1A\u52A1\u573A\u666F",trigger:"change"}],checkRules:[{required:!0,message:"\u8BF7\u9009\u62E9\u5185\u5BB9\u68C0\u67E5",trigger:"change"}],templateId:[{required:!0,message:"\u8BF7\u9009\u62E9\u6392\u7248\u6A21\u677F",trigger:"change"}],reviewListOption:[{required:!0,message:"\u8BF7\u9009\u62E9\u6392\u7248\u6E05\u5355\u9009\u9879",trigger:"change"},{validator:(n,l,r)=>{l==="\u4ECE\u77E5\u8BC6\u5E93\u9009\u62E9"&&!e.selectedScenario?r(new Error("\u4ECE\u77E5\u8BC6\u5E93\u9009\u62E9\u65F6\uFF0C\u8BF7\u9009\u62E9\u5177\u4F53\u7684\u5217\u8868\u9879")):r()},trigger:"change"}]}),W=async()=>{e.isCheckRule=!0;const n=V.value;!n||n.validate(l=>{if(l){e.sceneId=k.currentSceneInfo.id,e.channelStreamId=E.value,v.value=j.service({lock:!0,background:"rgba(255, 255, 255, 0.4)",customClass:"custom-loading"});let r="\u6B63\u5728\u5BF9\u5185\u5BB9\u8FDB\u884C\u68C0\u67E5\uFF0C\u8BF7\u7A0D\u7B49.";v.value.setText(r),_("getContentPromptContent",async m=>{const u=k.currentSceneInfo.contentReviewerEngineer;_("genSingleChapterContent",u),e.roleId=u,e.contentPromptContent=m;let p=[];const R=e.checkRules;for(let h=0;h<R.length;h++){const I=R[h];r="\u6B63\u5728\u5BF9\u5185\u5BB9\u8FDB\u884C["+T.value.filter(F=>F.id==I)[0].checkItem+"]\u68C0\u67E5\uFF0C\u8BF7\u7A0D\u7B49.",v.value.setText(r),e.ruleIds=[I];const C=await pe(e);console.log("res = "+C.data),p.push(...C.data)}v.value.close(),_("displayDocumentReviewList",p)})}})},M=async()=>{const n=V.value;!n||await n.validate(l=>{if(l){console.log("submit!",e),e.sceneId=k.currentSceneInfo.id,e.channelStreamId=E.value,v.value=j.service({lock:!0,background:"rgba(255, 255, 255, 0.4)",customClass:"custom-loading"});let r="\u6B63\u5728\u4F7F\u7528\u6A21\u677F\u751F\u6210\u4E1A\u52A1\u5185\u5BB9\uFF0C\u8BF7\u7A0D\u7B49.";v.value.setText(r),_("getContentPromptContent",m=>{const u=k.currentSceneInfo.templateExtractorEngineer;_("genSingleChapterContent",u),e.roleId=u,e.contentPromptContent=m,me(e).then(p=>{console.log("res = "+p),v.value.close(),_("handleStepClick",1),N.value=p.data,H(p.data)})})}else console.log("error submit!")})},$=()=>{ve(N.value).then(n=>{window.open(n.data)})},H=async n=>{try{L.value=!0,O.value=!0,ce(()=>{ge(n).then(l=>{console.log("response.data:"+l),P.value=window.URL.createObjectURL(l),O.value=!1,console.log("\u6587\u6863\u6E32\u67D3\u6210\u529F")})})}catch(l){console.error("\u83B7\u53D6\u6216\u6E32\u67D3\u6587\u6863\u5931\u8D25",l)}},K=()=>{_e().then(n=>{z.value=n.data})},Q=()=>{be().then(n=>{T.value=n.data})},X=()=>{localStorage.setItem("ruleForm",JSON.stringify({documentType:e.documentType,businessScenario:e.businessScenario,templateId:e.templateId,reviewListOption:e.reviewListOption,isCheckRule:e.isCheckRule,checkRules:e.checkRules}))},Y=()=>{const n=localStorage.getItem("ruleForm");if(n){const l=JSON.parse(n);e.documentType=l.documentType,e.businessScenario=l.businessScenario,e.templateId=l.templateId,e.reviewListOption=l.reviewListOption||"dataset",e.isCheckRule=l.isCheckRule||!1,e.checkRules=l.checkRules||[]}};return oe([()=>e.isCheckRule,()=>e.checkRules,()=>e.documentType,()=>e.businessScenario,()=>e.templateId],()=>{X()}),ne(()=>{Y(),K(),Q()}),(n,l)=>{const r=c("el-option"),m=c("el-select"),u=c("el-form-item"),p=c("el-radio"),R=c("el-radio-group"),h=c("el-input"),I=c("el-checkbox"),D=c("el-col"),C=c("el-row"),F=c("el-form"),U=c("el-button"),Z=c("el-scrollbar"),ee=c("el-dialog"),le=se("loading");return d(),b("div",fe,[i("div",he,[ye,i("div",we,[a(F,{ref_key:"ruleFormRef",ref:V,model:e,rules:J,"label-width":"120px","label-position":"top",size:"large"},{default:o(()=>[a(u,{label:"\u9009\u62E9\u6587\u4E66\u7C7B\u578B",prop:"documentType"},{default:o(()=>[a(m,{modelValue:e.documentType,"onUpdate:modelValue":l[0]||(l[0]=t=>e.documentType=t),multiple:"","collapse-tags":"","collapse-tags-tooltip":"",placeholder:"\u8BF7\u9009\u62E9\u6587\u4E66\u7C7B\u578B",style:{width:"100%"}},{default:o(()=>[(d(!0),b(S,null,x(G.value,t=>(d(),y(r,{key:t.value,border:!1,value:t.value,label:t.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(u,{label:"\u9009\u62E9\u4E1A\u52A1\u573A\u666F",prop:"businessScenario"},{default:o(()=>[a(m,{modelValue:e.businessScenario,"onUpdate:modelValue":l[1]||(l[1]=t=>e.businessScenario=t),multiple:"","collapse-tags":"","collapse-tags-tooltip":"",placeholder:"\u8BF7\u9009\u62E9\u4E1A\u52A1\u573A\u666F",style:{width:"100%"}},{default:o(()=>[(d(!0),b(S,null,x(A.value,t=>(d(),y(r,{key:t.value,border:!1,value:t.value,label:t.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(u,{label:"\u9009\u62E9\u6392\u7248\u6E05\u5355"},{default:o(()=>[a(R,{modelValue:e.reviewListOption,"onUpdate:modelValue":l[2]||(l[2]=t=>e.reviewListOption=t)},{default:o(()=>[a(p,{value:"aigen",label:"AI\u667A\u80FD\u751F\u6210",border:"",disabled:!0},{default:o(()=>[ke,w(" \xA0 AI\u667A\u80FD\u751F\u6210 ")]),_:1}),a(p,{value:"dataset",label:"\u4ECE\u6A21\u677F\u5E93\u9009\u62E9",border:""},{default:o(()=>[Re,w(" \xA0 \u4ECE\u6A21\u677F\u5E93\u9009\u62E9 ")]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(u,{label:"\u9009\u62E9\u6392\u7248\u6A21\u677F",prop:"templateId"},{default:o(()=>[a(m,{placeholder:"\u9009\u62E9\u6392\u7248\u6A21\u677F",modelValue:e.templateId,"onUpdate:modelValue":l[3]||(l[3]=t=>e.templateId=t),disabled:e.reviewListOption!=="dataset"},{default:o(()=>[(d(!0),b(S,null,x(z.value,t=>(d(),y(r,{key:t.id,label:t.templateName,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),a(u,{label:e.isCheckRule?"\u68C0\u67E5\u8981\u6C42":"\u751F\u6210\u8981\u6C42",prop:"requirement"},{default:o(()=>[a(h,{modelValue:e.requirement,"onUpdate:modelValue":l[4]||(l[4]=t=>e.requirement=t),type:"input",placeholder:"\u8BF7\u8F93\u5165\u8981\u6C42\uFF0C\u6BD4\u5982\u5185\u5BB9\u63CF\u8FF0\u4E30\u5BCC\u4E00\u4E9B"},null,8,["modelValue"])]),_:1},8,["label"]),a(C,null,{default:o(()=>[a(D,{span:4},{default:o(()=>[a(u,{label:"\u5185\u5BB9\u68C0\u67E5",prop:"isCheckRule"},{default:o(()=>[a(I,{modelValue:e.isCheckRule,"onUpdate:modelValue":l[5]||(l[5]=t=>e.isCheckRule=t),border:""},{default:o(()=>[Ie]),_:1},8,["modelValue"])]),_:1})]),_:1}),a(D,{span:20},{default:o(()=>[e.isCheckRule?(d(),y(u,{key:0,label:"\u9009\u62E9\u68C0\u67E5\u8981\u6C42",prop:"checkRules"},{default:o(()=>[a(m,{modelValue:e.checkRules,"onUpdate:modelValue":l[6]||(l[6]=t=>e.checkRules=t),multiple:"","collapse-tags":"","collapse-tags-tooltip":"",placeholder:"\u8BF7\u9009\u62E9\u68C0\u67E5\u8981\u6C42",style:{width:"100%"}},{default:o(()=>[(d(!0),b(S,null,x(T.value,t=>(d(),y(r,{key:t.id,border:!1,value:t.id,label:t.checkItem},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1})):re("",!0)]),_:1})]),_:1})]),_:1},8,["model","rules"])])]),i("div",Ce,[a(U,{style:{width:"50%"},type:"danger",size:"large",onClick:W},{default:o(()=>[Se,w(" \xA0 \u5185\u5BB9\u68C0\u67E5 ")]),_:1}),a(U,{style:{width:"50%"},type:"primary",size:"large",onClick:M},{default:o(()=>[xe,w(" \xA0 \u5185\u5BB9\u6392\u7248 ")]),_:1})]),a(ee,{modelValue:L.value,"onUpdate:modelValue":l[8]||(l[8]=t=>L.value=t),title:"\u6587\u6863\u9884\u89C8",width:"60%","destroy-on-close":"","append-to-body":""},{default:o(()=>[ue((d(),b("div",Ve,[a(Z,{class:"scrollable-area",style:{height:"calc(75vh)","margin-top":"0px","padding-right":"0px"}},{default:o(()=>[i("iframe",{src:P.value,style:{position:"absolute",width:"100%",height:"100%",border:"0px","padding-bottom":"10px",background:"#323639"}},`
                        `,8,Le)]),_:1})])),[[le,O.value]]),i("div",Te,[a(U,{type:"primary",size:"large",onClick:l[7]||(l[7]=t=>$())},{default:o(()=>[Oe,w(" \u4E0B\u8F7D\u751F\u6210Word\u5185\u5BB9 ")]),_:1})])]),_:1},8,["modelValue"])])}}},Ee=te(De,[["__scopeId","data-v-c5b60826"]]);export{Ee as default};
