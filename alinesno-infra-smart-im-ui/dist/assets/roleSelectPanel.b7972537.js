import{_ as N,g as B,r as t,j as L,k as E,o as z,a as h,b as r,c as u,l as A,t as b,e as w,d as _,w as k,F as T,f as C,n as D,m as F,s as M}from"./index.d9d30be3.js";import U from"./configSceneAgent.f1635811.js";const j={class:"review-header-title"},q={style:{display:"flex",gap:"20px","align-items":"center"}},G=["src"],H={__name:"roleSelectPanel",emits:["openExecuteHandle"],setup($,{expose:P,emit:J}){const R=B(),i=t(R.query.sceneId),d=t(!1),f=t(""),p=t([]),v=t(null),y=t(null),l=t(null),g=t([]),c=t({});function m(){d.value=!0,f.value=l.value.sceneName+"\u914D\u7F6E",D(()=>{y.value.configSceneAgent(l.value,p.value)})}const S=async()=>{if(!!i.value)try{const[n,e]=await Promise.all([F(i.value),M()]);l.value=n.data,p.value=e.data;const s=p.value.filter(a=>a.code===l.value.sceneType);s.length>0?(v.value=s[0],g.value=v.value.agents):v.value=null}catch(n){console.error("\u83B7\u53D6\u573A\u666F\u4FE1\u606F\u5931\u8D25:",n)}};return L(g,n=>{n.forEach(async e=>{const s={sceneId:i.value,sceneTypeCode:l.value.sceneType,agentTypeId:e.id,agentTypeCode:e.code};try{const a=await E(s);c.value={...c.value,[e.id]:a.data}}catch(a){console.error("\u83B7\u53D6\u89D2\u8272\u5217\u8868\u5931\u8D25:",a),c.value={...c.value,[e.id]:[]}}})},{immediate:!0}),z(async()=>{await S()}),P({configAgent:m}),(n,e)=>{var x;const s=h("el-button"),a=h("el-dialog");return r(),u("div",j,[A(b((x=l.value)==null?void 0:x.sceneName)+" ",1),w("div",q,[_(s,{text:"",bg:"",type:"primary",size:"large",onClick:e[0]||(e[0]=o=>m())},{default:k(()=>[A("\u9009\u62E9\u89D2\u8272")]),_:1}),(r(!0),u(T,null,C(g.value,o=>(r(),u("div",{style:{display:"flex","align-items":"center",gap:"10px","font-size":"14px"},key:o.id},[w("span",null,b(o.name),1),(r(!0),u(T,null,C(c.value[o.id],(V,I)=>(r(),u("img",{class:"review-agent",key:I,src:n.imagePathByPath(V.roleAvatar)},null,8,G))),128))]))),128))]),_(a,{modelValue:d.value,"onUpdate:modelValue":e[1]||(e[1]=o=>d.value=o),title:f.value,width:"960px"},{default:k(()=>[_(U,{ref_key:"configSceneAgentRef",ref:y,onUpdateSceneAgents:S},null,512)]),_:1},8,["modelValue","title"])])}}},Q=N(H,[["__scopeId","data-v-b1bcffae"]]);export{Q as default};
